OBJECT Table 23 Vendor
{
  OBJECT-PROPERTIES
  {
    Date=08-11-17;
    Time=08:00:00;
    Version List=NAVW110.00.00.15052,NAVNA10.00.00.15052,SER10.00.00.08;
  }
  PROPERTIES
  {
    Permissions=TableData 25=r;
    DataCaptionFields=No.,Name;
    OnInsert=BEGIN
               IF "No." = '' THEN BEGIN
                 PurchSetup.GET;
                 PurchSetup.TESTFIELD("Vendor Nos.");
                 NoSeriesMgt.InitSeries(PurchSetup."Vendor Nos.",xRec."No. Series",0D,"No.","No. Series");
               END;

               IF "Invoice Disc. Code" = '' THEN
                 "Invoice Disc. Code" := "No.";

               IF NOT (InsertFromContact OR (InsertFromTemplate AND (Contact <> ''))) THEN
                 UpdateContFromVend.OnInsert(Rec);

               DimMgt.UpdateDefaultDim(
                 DATABASE::Vendor,"No.",
                 "Global Dimension 1 Code","Global Dimension 2 Code",

                 //Navigator
                 "Global Dimension 3 Code","Global Dimension 4 Code",
                 "Global Dimension 5 Code","Global Dimension 6 Code",
                 "Global Dimension 7 Code","Global Dimension 8 Code");

               //Navigator
               FundManagement.SetControlFundAP("Payables Fund No.");
               PurchSetup.GET;
               IF ("Vendor Posting Group" = '') AND (PurchSetup."Default Vendor Posting Group" <> '') THEN
                 "Vendor Posting Group" := PurchSetup."Default Vendor Posting Group";
               IF ("Gen. Bus. Posting Group" = '') AND (PurchSetup."Default Business Posting Group" <> '') THEN BEGIN
                 "Gen. Bus. Posting Group" := PurchSetup."Default Business Posting Group";
                 IF GenBusPostingGrp.ValidateVatBusPostingGroup(GenBusPostingGrp,"Gen. Bus. Posting Group") THEN
                   VALIDATE("VAT Bus. Posting Group",GenBusPostingGrp."Def. VAT Bus. Posting Group");
               END;
               IF ("Purchaser Code" = '') AND (PurchSetup."Default Purchaser Code" <> '') THEN
                 "Purchaser Code" := PurchSetup."Default Purchaser Code";
               "Created By" := USERID;
               "Date Created" := TODAY;

               IF EFExtFieldEntry.READPERMISSION THEN
                 EFExtendedFieldsMgt.AllowedTableOnInsert(DATABASE::Vendor, "No.", '', '');
             END;

    OnModify=BEGIN
               "Last Date Modified" := TODAY;

               IF (Name <> xRec.Name) OR
                  ("Search Name" <> xRec."Search Name") OR
                  ("Name 2" <> xRec."Name 2") OR
                  (Address <> xRec.Address) OR
                  ("Address 2" <> xRec."Address 2") OR
                  (City <> xRec.City) OR
                  ("Phone No." <> xRec."Phone No.") OR
                  ("Telex No." <> xRec."Telex No.") OR
                  ("Territory Code" <> xRec."Territory Code") OR
                  ("Currency Code" <> xRec."Currency Code") OR
                  ("Language Code" <> xRec."Language Code") OR
                  ("Purchaser Code" <> xRec."Purchaser Code") OR
                  ("Country/Region Code" <> xRec."Country/Region Code") OR
                  ("Fax No." <> xRec."Fax No.") OR
                  ("Telex Answer Back" <> xRec."Telex Answer Back") OR
                  ("VAT Registration No." <> xRec."VAT Registration No.") OR
                  ("Post Code" <> xRec."Post Code") OR
                  (County <> xRec.County) OR
                  ("E-Mail" <> xRec."E-Mail") OR
                  ("Home Page" <> xRec."Home Page")
               THEN BEGIN
                 MODIFY;
                 UpdateContFromVend.OnModify(Rec);
                 IF NOT FIND THEN BEGIN
                   RESET;
                   IF FIND THEN;
                 END;
               END;

               //Navigator
               IF "Payables Fund No." = '' THEN
                 FundManagement.SetControlFundAP("Payables Fund No.");
               "Last Modified By" := USERID;
               MODIFY;
               IF BusinessEntityRelation.READPERMISSION THEN
                 BusinessEntityRelation.Transfer(DATABASE::Vendor,"No.");
             END;

    OnDelete=VAR
               ItemVendor@1000 : Record 99;
               PurchPrice@1001 : Record 7012;
               PurchLineDiscount@1002 : Record 7014;
               PurchPrepmtPct@1003 : Record 460;
               SocialListeningSearchTopic@1005 : Record 871;
               CustomReportSelection@1006 : Record 9657;
               PurchOrderLine@1007 : Record 39;
               VATRegistrationLogMgt@1004 : Codeunit 249;
             BEGIN
               ApprovalsMgmt.OnCancelVendorApprovalRequest(Rec);

               MoveEntries.MoveVendorEntries(Rec);

               CommentLine.SETRANGE("Table Name",CommentLine."Table Name"::Vendor);
               CommentLine.SETRANGE("No.","No.");
               CommentLine.DELETEALL;

               VendBankAcc.SETRANGE("Vendor No.","No.");
               VendBankAcc.DELETEALL;

               OrderAddr.SETRANGE("Vendor No.","No.");
               OrderAddr.DELETEALL;

               ItemCrossReference.SETCURRENTKEY("Cross-Reference Type","Cross-Reference Type No.");
               ItemCrossReference.SETRANGE("Cross-Reference Type",ItemCrossReference."Cross-Reference Type"::Vendor);
               ItemCrossReference.SETRANGE("Cross-Reference Type No.","No.");
               ItemCrossReference.DELETEALL;

               PurchOrderLine.SETCURRENTKEY("Document Type","Pay-to Vendor No.");
               PurchOrderLine.SETFILTER(
                 "Document Type",'%1|%2',
                 PurchOrderLine."Document Type"::Order,
                 PurchOrderLine."Document Type"::"Return Order");
               PurchOrderLine.SETRANGE("Pay-to Vendor No.","No.");
               IF PurchOrderLine.FINDFIRST THEN
                 ERROR(
                   Text000,
                   TABLECAPTION,"No.",
                   PurchOrderLine."Document Type");

               PurchOrderLine.SETRANGE("Pay-to Vendor No.");
               PurchOrderLine.SETRANGE("Buy-from Vendor No.","No.");
               IF NOT PurchOrderLine.ISEMPTY THEN
                 ERROR(
                   Text000,
                   TABLECAPTION,"No.");


               UpdateContFromVend.OnDelete(Rec);

               DimMgt.DeleteDefaultDim(DATABASE::Vendor,"No.");

               ServiceItem.SETRANGE("Vendor No.","No.");
               ServiceItem.MODIFYALL("Vendor No.",'');

               ItemVendor.SETRANGE("Vendor No.","No.");
               ItemVendor.DELETEALL(TRUE);

               IF NOT SocialListeningSearchTopic.ISEMPTY THEN BEGIN
                 SocialListeningSearchTopic.FindSearchTopic(SocialListeningSearchTopic."Source Type"::Vendor,"No.");
                 SocialListeningSearchTopic.DELETEALL;
               END;

               PurchPrice.SETCURRENTKEY("Vendor No.");
               PurchPrice.SETRANGE("Vendor No.","No.");
               PurchPrice.DELETEALL(TRUE);

               PurchLineDiscount.SETCURRENTKEY("Vendor No.");
               PurchLineDiscount.SETRANGE("Vendor No.","No.");
               PurchLineDiscount.DELETEALL(TRUE);

               CustomReportSelection.SETRANGE("Source Type",DATABASE::Vendor);
               CustomReportSelection.SETRANGE("Source No.","No.");
               CustomReportSelection.DELETEALL;

               PurchPrepmtPct.SETCURRENTKEY("Vendor No.");
               PurchPrepmtPct.SETRANGE("Vendor No.","No.");
               PurchPrepmtPct.DELETEALL(TRUE);

               VATRegistrationLogMgt.DeleteVendorLog(Rec);

               //Navigator
               IF FileAttachment.READPERMISSION THEN
                 FileAttachment.DeleteDocuments(DATABASE::Vendor,"No.",'','');
               IF BusinessEntityRelation.READPERMISSION THEN
                 BusinessEntityRelation.DeleteCheck(DATABASE::Vendor,"No.");

               IF EFExtFieldEntry.READPERMISSION THEN
                 EFExtendedFieldsMgt.AllowedTableOnDelete(DATABASE::Vendor, "No.", '', '');
             END;

    OnRename=BEGIN
               ApprovalsMgmt.RenameApprovalEntries(xRec.RECORDID,RECORDID);
               "Last Date Modified" := TODAY;

               //Navigator
               "Last Modified By" := USERID;

               IF EFExtFieldEntry.READPERMISSION THEN
                 EFExtendedFieldsMgt.AllowedTableOnRename(DATABASE::Vendor, xRec."No.", '', '', "No.", '', '');
             END;

    CaptionML=[ENU=Vendor;
               ENC=Vendor];
    LookupPageID=Page27;
    DrillDownPageID=Page27;
  }
  FIELDS
  {
    { 1   ;   ;No.                 ;Code20        ;OnValidate=BEGIN
                                                                IF "No." <> xRec."No." THEN BEGIN
                                                                  PurchSetup.GET;
                                                                  NoSeriesMgt.TestManual(PurchSetup."Vendor Nos.");
                                                                  "No. Series" := '';
                                                                END;
                                                                IF "Invoice Disc. Code" = '' THEN
                                                                  "Invoice Disc. Code" := "No.";
                                                              END;

                                                   AltSearchField=Search Name;
                                                   CaptionML=[ENU=No.;
                                                              ENC=No.] }
    { 2   ;   ;Name                ;Text50        ;OnValidate=BEGIN
                                                                IF ("Search Name" = UPPERCASE(xRec.Name)) OR ("Search Name" = '') THEN
                                                                  "Search Name" := Name;
                                                              END;

                                                   CaptionML=[ENU=Name;
                                                              ENC=Name] }
    { 3   ;   ;Search Name         ;Code50        ;CaptionML=[ENU=Search Name;
                                                              ENC=Search Name] }
    { 4   ;   ;Name 2              ;Text50        ;CaptionML=[ENU=Name 2;
                                                              ENC=Name 2] }
    { 5   ;   ;Address             ;Text50        ;CaptionML=[ENU=Address;
                                                              ENC=Address] }
    { 6   ;   ;Address 2           ;Text50        ;CaptionML=[ENU=Address 2;
                                                              ENC=Address 2] }
    { 7   ;   ;City                ;Text30        ;TableRelation=IF (Country/Region Code=CONST()) "Post Code".City
                                                                 ELSE IF (Country/Region Code=FILTER(<>'')) "Post Code".City WHERE (Country/Region Code=FIELD(Country/Region Code));
                                                   OnValidate=BEGIN
                                                                PostCode.ValidateCity(City,"Post Code",County,"Country/Region Code",(CurrFieldNo <> 0) AND GUIALLOWED);
                                                              END;

                                                   ValidateTableRelation=No;
                                                   TestTableRelation=No;
                                                   CaptionML=[ENU=City;
                                                              ENC=City] }
    { 8   ;   ;Contact             ;Text50        ;OnValidate=VAR
                                                                Cont@1000 : Record 5050;
                                                              BEGIN
                                                                //Navigator
                                                                //IF RMSetup.GET THEN
                                                                //  IF RMSetup."Bus. Rel. Code for Vendors" <> '' THEN BEGIN
                                                                //    IF (xRec.Contact = '') AND (xRec."Primary Contact No." = '') AND (Contact <> '') THEN BEGIN
                                                                //      MODIFY;
                                                                //      UpdateContFromVend.OnModify(Rec);
                                                                //      UpdateContFromVend.InsertNewContactPerson(Rec,FALSE);
                                                                //      MODIFY(TRUE);
                                                                //    END;
                                                                //    EXIT;
                                                                //  END;
                                                                //
                                                                //IF Cont.GET("Primary Contact No.") THEN
                                                                //  IF Cont.Name = Contact THEN
                                                                //    EXIT;
                                                                //
                                                                //VALIDATE("Primary Contact No.",'');
                                                              END;

                                                   OnLookup=VAR
                                                              ContactBusinessRelation@1001 : Record 5054;
                                                              Cont@1000 : Record 5050;
                                                            BEGIN
                                                              //Navigator
                                                              //ContactBusinessRelation.SETCURRENTKEY("Link to Table","No.");
                                                              //ContactBusinessRelation.SETRANGE("Link to Table",ContactBusinessRelation."Link to Table"::Vendor);
                                                              //ContactBusinessRelation.SETRANGE("No.","No.");
                                                              //IF ContactBusinessRelation.FINDFIRST THEN
                                                              //  Cont.SETRANGE("Company No.",ContactBusinessRelation."Contact No.")
                                                              //ELSE
                                                              //  Cont.SETRANGE("Company No.",'');
                                                              //
                                                              //IF "Primary Contact No." <> '' THEN
                                                              //  IF Cont.GET("Primary Contact No.") THEN ;
                                                              //IF PAGE.RUNMODAL(0,Cont) = ACTION::LookupOK THEN
                                                              //  VALIDATE("Primary Contact No.",Cont."No.");
                                                            END;

                                                   CaptionML=[ENU=Contact;
                                                              ENC=Contact] }
    { 9   ;   ;Phone No.           ;Text30        ;ExtendedDatatype=Phone No.;
                                                   CaptionML=[ENU=Phone No.;
                                                              ENC=Phone No.] }
    { 10  ;   ;Telex No.           ;Text20        ;CaptionML=[ENU=Telex No.;
                                                              ENC=Telex No.] }
    { 14  ;   ;Our Account No.     ;Text20        ;CaptionML=[ENU=Our Account No.;
                                                              ENC=Our Account No.] }
    { 15  ;   ;Territory Code      ;Code10        ;TableRelation=Territory;
                                                   CaptionML=[ENU=Territory Code;
                                                              ENC=Territory Code] }
    { 16  ;   ;Global Dimension 1 Code;Code20     ;TableRelation="Dimension Value".Code WHERE (Global Dimension No.=CONST(1));
                                                   OnValidate=BEGIN
                                                                ValidateShortcutDimCode(1,"Global Dimension 1 Code");
                                                              END;

                                                   CaptionML=[ENU=Global Dimension 1 Code;
                                                              ENC=Global Dimension 1 Code];
                                                   CaptionClass='1,1,1' }
    { 17  ;   ;Global Dimension 2 Code;Code20     ;TableRelation="Dimension Value".Code WHERE (Global Dimension No.=CONST(2));
                                                   OnValidate=BEGIN
                                                                ValidateShortcutDimCode(2,"Global Dimension 2 Code");
                                                              END;

                                                   CaptionML=[ENU=Global Dimension 2 Code;
                                                              ENC=Global Dimension 2 Code];
                                                   CaptionClass='1,1,2' }
    { 19  ;   ;Budgeted Amount     ;Decimal       ;CaptionML=[ENU=Budgeted Amount;
                                                              ENC=Budgeted Amount];
                                                   AutoFormatType=1;
                                                   AutoFormatExpr="Currency Code" }
    { 21  ;   ;Vendor Posting Group;Code10        ;TableRelation="Vendor Posting Group";
                                                   CaptionML=[ENU=Vendor Posting Group;
                                                              ENC=Vendor Posting Group] }
    { 22  ;   ;Currency Code       ;Code10        ;TableRelation=Currency;
                                                   CaptionML=[ENU=Currency Code;
                                                              ENC=Currency Code] }
    { 24  ;   ;Language Code       ;Code10        ;TableRelation=Language;
                                                   CaptionML=[ENU=Language Code;
                                                              ENC=Language Code] }
    { 26  ;   ;Statistics Group    ;Integer       ;CaptionML=[ENU=Statistics Group;
                                                              ENC=Statistics Group] }
    { 27  ;   ;Payment Terms Code  ;Code10        ;TableRelation="Payment Terms";
                                                   CaptionML=[ENU=Payment Terms Code;
                                                              ENC=Payment Terms Code] }
    { 28  ;   ;Fin. Charge Terms Code;Code10      ;TableRelation="Finance Charge Terms";
                                                   CaptionML=[ENU=Fin. Charge Terms Code;
                                                              ENC=Fin. Charge Terms Code] }
    { 29  ;   ;Purchaser Code      ;Code50        ;TableRelation="User Setup" WHERE (Purchaser=FILTER(Yes));
                                                   TestTableRelation=No;
                                                   CaptionML=[ENU=Purchaser Code;
                                                              ENC=Purchaser Code] }
    { 30  ;   ;Shipment Method Code;Code10        ;TableRelation="Shipment Method";
                                                   CaptionML=[ENU=Shipment Method Code;
                                                              ENC=Shipment Method Code] }
    { 31  ;   ;Shipping Agent Code ;Code10        ;TableRelation="Shipping Agent";
                                                   CaptionML=[ENU=Shipping Agent Code;
                                                              ENC=Shipping Agent Code] }
    { 33  ;   ;Invoice Disc. Code  ;Code20        ;TableRelation=Vendor;
                                                   ValidateTableRelation=No;
                                                   TestTableRelation=No;
                                                   CaptionML=[ENU=Invoice Disc. Code;
                                                              ENC=Invoice Disc. Code] }
    { 35  ;   ;Country/Region Code ;Code10        ;TableRelation=Country/Region;
                                                   CaptionML=[ENU=Country/Region Code;
                                                              ENC=Country/Region Code] }
    { 38  ;   ;Comment             ;Boolean       ;FieldClass=FlowField;
                                                   CalcFormula=Exist("Comment Line" WHERE (Table Name=CONST(Vendor),
                                                                                           No.=FIELD(No.)));
                                                   CaptionML=[ENU=Comment;
                                                              ENC=Comment];
                                                   Editable=No }
    { 39  ;   ;Blocked             ;Option        ;CaptionML=[ENU=Blocked;
                                                              ENC=Blocked];
                                                   OptionCaptionML=[ENU=" ,Payment,All";
                                                                    ENC=" ,Payment,All"];
                                                   OptionString=[ ,Payment,All] }
    { 45  ;   ;Pay-to Vendor No.   ;Code20        ;TableRelation=Vendor;
                                                   CaptionML=[ENU=Vendor No.;
                                                              ENC=Pay-to Vendor No.] }
    { 46  ;   ;Priority            ;Integer       ;CaptionML=[ENU=Priority;
                                                              ENC=Priority] }
    { 47  ;   ;Payment Method Code ;Code10        ;TableRelation="Payment Method";
                                                   CaptionML=[ENU=Payment Method Code;
                                                              ENC=Payment Method Code] }
    { 54  ;   ;Last Date Modified  ;Date          ;CaptionML=[ENU=Last Date Modified;
                                                              ENC=Last Date Modified];
                                                   Editable=No }
    { 55  ;   ;Date Filter         ;Date          ;FieldClass=FlowFilter;
                                                   CaptionML=[ENU=Date Filter;
                                                              ENC=Date Filter] }
    { 56  ;   ;Global Dimension 1 Filter;Code20   ;FieldClass=FlowFilter;
                                                   TableRelation="Dimension Value".Code WHERE (Global Dimension No.=CONST(1));
                                                   CaptionML=[ENU=Global Dimension 1 Filter;
                                                              ENC=Global Dimension 1 Filter];
                                                   CaptionClass='1,3,1' }
    { 57  ;   ;Global Dimension 2 Filter;Code20   ;FieldClass=FlowFilter;
                                                   TableRelation="Dimension Value".Code WHERE (Global Dimension No.=CONST(2));
                                                   CaptionML=[ENU=Global Dimension 2 Filter;
                                                              ENC=Global Dimension 2 Filter];
                                                   CaptionClass='1,3,2' }
    { 58  ;   ;Balance             ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=-Sum("Detailed Vendor Ledg. Entry".Amount WHERE (Vendor No.=FIELD(No.),
                                                                                                                Initial Entry Global Dim. 1=FIELD(Global Dimension 1 Filter),
                                                                                                                Initial Entry Global Dim. 2=FIELD(Global Dimension 2 Filter),
                                                                                                                Currency Code=FIELD(Currency Filter),
                                                                                                                Fund No.=FIELD(Fund Filter),
                                                                                                                Initial Entry Global Dim. 3=FIELD(Global Dimension 3 Filter),
                                                                                                                Initial Entry Global Dim. 4=FIELD(Global Dimension 4 Filter),
                                                                                                                Initial Entry Global Dim. 5=FIELD(Global Dimension 5 Filter),
                                                                                                                Initial Entry Global Dim. 6=FIELD(Global Dimension 6 Filter),
                                                                                                                Initial Entry Global Dim. 7=FIELD(Global Dimension 7 Filter),
                                                                                                                Initial Entry Global Dim. 8=FIELD(Global Dimension 8 Filter)));
                                                   CaptionML=[ENU=Balance;
                                                              ENC=Balance];
                                                   Editable=No;
                                                   AutoFormatType=1;
                                                   AutoFormatExpr="Currency Code" }
    { 59  ;   ;Balance (LCY)       ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=-Sum("Detailed Vendor Ledg. Entry"."Amount (LCY)" WHERE (Vendor No.=FIELD(No.),
                                                                                                                        Initial Entry Global Dim. 1=FIELD(Global Dimension 1 Filter),
                                                                                                                        Initial Entry Global Dim. 2=FIELD(Global Dimension 2 Filter),
                                                                                                                        Currency Code=FIELD(Currency Filter),
                                                                                                                        Fund No.=FIELD(Fund Filter),
                                                                                                                        Initial Entry Global Dim. 3=FIELD(Global Dimension 3 Filter),
                                                                                                                        Initial Entry Global Dim. 4=FIELD(Global Dimension 4 Filter),
                                                                                                                        Initial Entry Global Dim. 5=FIELD(Global Dimension 5 Filter),
                                                                                                                        Initial Entry Global Dim. 6=FIELD(Global Dimension 6 Filter),
                                                                                                                        Initial Entry Global Dim. 7=FIELD(Global Dimension 7 Filter),
                                                                                                                        Initial Entry Global Dim. 8=FIELD(Global Dimension 8 Filter)));
                                                   CaptionML=[ENU=Balance (LCY);
                                                              ENC=Balance (LCY)];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 60  ;   ;Net Change          ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=-Sum("Detailed Vendor Ledg. Entry".Amount WHERE (Vendor No.=FIELD(No.),
                                                                                                                Initial Entry Global Dim. 1=FIELD(Global Dimension 1 Filter),
                                                                                                                Initial Entry Global Dim. 2=FIELD(Global Dimension 2 Filter),
                                                                                                                Posting Date=FIELD(Date Filter),
                                                                                                                Currency Code=FIELD(Currency Filter),
                                                                                                                Fund No.=FIELD(Fund Filter),
                                                                                                                Initial Entry Global Dim. 3=FIELD(Global Dimension 3 Filter),
                                                                                                                Initial Entry Global Dim. 4=FIELD(Global Dimension 4 Filter),
                                                                                                                Initial Entry Global Dim. 5=FIELD(Global Dimension 5 Filter),
                                                                                                                Initial Entry Global Dim. 6=FIELD(Global Dimension 6 Filter),
                                                                                                                Initial Entry Global Dim. 7=FIELD(Global Dimension 7 Filter),
                                                                                                                Initial Entry Global Dim. 8=FIELD(Global Dimension 8 Filter)));
                                                   CaptionML=[ENU=Net Change;
                                                              ENC=Net Change];
                                                   Editable=No;
                                                   AutoFormatType=1;
                                                   AutoFormatExpr="Currency Code" }
    { 61  ;   ;Net Change (LCY)    ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=-Sum("Detailed Vendor Ledg. Entry"."Amount (LCY)" WHERE (Vendor No.=FIELD(No.),
                                                                                                                        Initial Entry Global Dim. 1=FIELD(Global Dimension 1 Filter),
                                                                                                                        Initial Entry Global Dim. 2=FIELD(Global Dimension 2 Filter),
                                                                                                                        Posting Date=FIELD(Date Filter),
                                                                                                                        Currency Code=FIELD(Currency Filter),
                                                                                                                        Fund No.=FIELD(Fund Filter),
                                                                                                                        Initial Entry Global Dim. 3=FIELD(Global Dimension 3 Filter),
                                                                                                                        Initial Entry Global Dim. 4=FIELD(Global Dimension 4 Filter),
                                                                                                                        Initial Entry Global Dim. 5=FIELD(Global Dimension 5 Filter),
                                                                                                                        Initial Entry Global Dim. 6=FIELD(Global Dimension 6 Filter),
                                                                                                                        Initial Entry Global Dim. 7=FIELD(Global Dimension 7 Filter),
                                                                                                                        Initial Entry Global Dim. 8=FIELD(Global Dimension 8 Filter)));
                                                   CaptionML=[ENU=Net Change (LCY);
                                                              ENC=Net Change (LCY)];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 62  ;   ;Purchases (LCY)     ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=-Sum("Vendor Ledger Entry"."Purchase (LCY)" WHERE (Vendor No.=FIELD(No.),
                                                                                                                  Global Dimension 1 Code=FIELD(Global Dimension 1 Filter),
                                                                                                                  Global Dimension 2 Code=FIELD(Global Dimension 2 Filter),
                                                                                                                  Posting Date=FIELD(Date Filter),
                                                                                                                  Currency Code=FIELD(Currency Filter),
                                                                                                                  Fund No.=FIELD(Fund Filter),
                                                                                                                  Global Dimension 3 Code=FIELD(Global Dimension 3 Filter),
                                                                                                                  Global Dimension 4 Code=FIELD(Global Dimension 4 Filter),
                                                                                                                  Global Dimension 5 Code=FIELD(Global Dimension 5 Filter),
                                                                                                                  Global Dimension 6 Code=FIELD(Global Dimension 6 Filter),
                                                                                                                  Global Dimension 7 Code=FIELD(Global Dimension 7 Filter),
                                                                                                                  Global Dimension 8 Code=FIELD(Global Dimension 8 Filter)));
                                                   CaptionML=[ENU=Purchases (LCY);
                                                              ENC=Purchases (LCY)];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 64  ;   ;Inv. Discounts (LCY);Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=-Sum("Vendor Ledger Entry"."Inv. Discount (LCY)" WHERE (Vendor No.=FIELD(No.),
                                                                                                                       Global Dimension 1 Code=FIELD(Global Dimension 1 Filter),
                                                                                                                       Global Dimension 2 Code=FIELD(Global Dimension 2 Filter),
                                                                                                                       Posting Date=FIELD(Date Filter),
                                                                                                                       Currency Code=FIELD(Currency Filter),
                                                                                                                       Fund No.=FIELD(Fund Filter),
                                                                                                                       Global Dimension 3 Code=FIELD(Global Dimension 3 Filter),
                                                                                                                       Global Dimension 4 Code=FIELD(Global Dimension 4 Filter),
                                                                                                                       Global Dimension 5 Code=FIELD(Global Dimension 5 Filter),
                                                                                                                       Global Dimension 6 Code=FIELD(Global Dimension 6 Filter),
                                                                                                                       Global Dimension 7 Code=FIELD(Global Dimension 7 Filter),
                                                                                                                       Global Dimension 8 Code=FIELD(Global Dimension 8 Filter)));
                                                   CaptionML=[ENU=Inv. Discounts (LCY);
                                                              ENC=Inv. Discounts (LCY)];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 65  ;   ;Pmt. Discounts (LCY);Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Detailed Vendor Ledg. Entry"."Amount (LCY)" WHERE (Vendor No.=FIELD(No.),
                                                                                                                       Entry Type=FILTER(Payment Discount..'Payment Discount (VAT Adjustment)'),
                                                                                                                       Initial Entry Global Dim. 1=FIELD(Global Dimension 1 Filter),
                                                                                                                       Initial Entry Global Dim. 2=FIELD(Global Dimension 2 Filter),
                                                                                                                       Posting Date=FIELD(Date Filter),
                                                                                                                       Currency Code=FIELD(Currency Filter),
                                                                                                                       Fund No.=FIELD(Fund Filter),
                                                                                                                       Initial Entry Global Dim. 3=FIELD(Global Dimension 3 Filter),
                                                                                                                       Initial Entry Global Dim. 4=FIELD(Global Dimension 4 Filter),
                                                                                                                       Initial Entry Global Dim. 5=FIELD(Global Dimension 5 Filter),
                                                                                                                       Initial Entry Global Dim. 6=FIELD(Global Dimension 6 Filter),
                                                                                                                       Initial Entry Global Dim. 7=FIELD(Global Dimension 7 Filter),
                                                                                                                       Initial Entry Global Dim. 8=FIELD(Global Dimension 8 Filter)));
                                                   CaptionML=[ENU=Pmt. Discounts (LCY);
                                                              ENC=Pmt. Discounts (LCY)];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 66  ;   ;Balance Due         ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=-Sum("Detailed Vendor Ledg. Entry".Amount WHERE (Vendor No.=FIELD(No.),
                                                                                                                Posting Date=FIELD(UPPERLIMIT(Date Filter)),
                                                                                                                Initial Entry Due Date=FIELD(Date Filter),
                                                                                                                Initial Entry Global Dim. 1=FIELD(Global Dimension 1 Filter),
                                                                                                                Initial Entry Global Dim. 2=FIELD(Global Dimension 2 Filter),
                                                                                                                Currency Code=FIELD(Currency Filter),
                                                                                                                Fund No.=FIELD(Fund Filter),
                                                                                                                Initial Entry Global Dim. 3=FIELD(Global Dimension 3 Filter),
                                                                                                                Initial Entry Global Dim. 4=FIELD(Global Dimension 4 Filter),
                                                                                                                Initial Entry Global Dim. 5=FIELD(Global Dimension 5 Filter),
                                                                                                                Initial Entry Global Dim. 6=FIELD(Global Dimension 6 Filter),
                                                                                                                Initial Entry Global Dim. 7=FIELD(Global Dimension 7 Filter),
                                                                                                                Initial Entry Global Dim. 8=FIELD(Global Dimension 8 Filter)));
                                                   CaptionML=[ENU=Balance Due;
                                                              ENC=Balance Due];
                                                   Editable=No;
                                                   AutoFormatType=1;
                                                   AutoFormatExpr="Currency Code" }
    { 67  ;   ;Balance Due (LCY)   ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=-Sum("Detailed Vendor Ledg. Entry"."Amount (LCY)" WHERE (Vendor No.=FIELD(No.),
                                                                                                                        Posting Date=FIELD(UPPERLIMIT(Date Filter)),
                                                                                                                        Initial Entry Due Date=FIELD(Date Filter),
                                                                                                                        Initial Entry Global Dim. 1=FIELD(Global Dimension 1 Filter),
                                                                                                                        Initial Entry Global Dim. 2=FIELD(Global Dimension 2 Filter),
                                                                                                                        Currency Code=FIELD(Currency Filter),
                                                                                                                        Fund No.=FIELD(Fund Filter),
                                                                                                                        Initial Entry Global Dim. 3=FIELD(Global Dimension 3 Filter),
                                                                                                                        Initial Entry Global Dim. 4=FIELD(Global Dimension 4 Filter),
                                                                                                                        Initial Entry Global Dim. 5=FIELD(Global Dimension 5 Filter),
                                                                                                                        Initial Entry Global Dim. 6=FIELD(Global Dimension 6 Filter),
                                                                                                                        Initial Entry Global Dim. 7=FIELD(Global Dimension 7 Filter),
                                                                                                                        Initial Entry Global Dim. 8=FIELD(Global Dimension 8 Filter)));
                                                   CaptionML=[ENU=Balance Due (LCY);
                                                              ENC=Balance Due (LCY)];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 69  ;   ;Payments            ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Detailed Vendor Ledg. Entry".Amount WHERE (Initial Document Type=CONST(Payment),
                                                                                                               Entry Type=CONST(Initial Entry),
                                                                                                               Vendor No.=FIELD(No.),
                                                                                                               Initial Entry Global Dim. 1=FIELD(Global Dimension 1 Filter),
                                                                                                               Initial Entry Global Dim. 2=FIELD(Global Dimension 2 Filter),
                                                                                                               Posting Date=FIELD(Date Filter),
                                                                                                               Currency Code=FIELD(Currency Filter),
                                                                                                               Fund No.=FIELD(Fund Filter),
                                                                                                               Initial Entry Global Dim. 3=FIELD(Global Dimension 3 Filter),
                                                                                                               Initial Entry Global Dim. 4=FIELD(Global Dimension 4 Filter),
                                                                                                               Initial Entry Global Dim. 5=FIELD(Global Dimension 5 Filter),
                                                                                                               Initial Entry Global Dim. 6=FIELD(Global Dimension 6 Filter),
                                                                                                               Initial Entry Global Dim. 7=FIELD(Global Dimension 7 Filter),
                                                                                                               Initial Entry Global Dim. 8=FIELD(Global Dimension 8 Filter)));
                                                   CaptionML=[ENU=Payments;
                                                              ENC=Payments];
                                                   Editable=No;
                                                   AutoFormatType=1;
                                                   AutoFormatExpr="Currency Code" }
    { 70  ;   ;Invoice Amounts     ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=-Sum("Detailed Vendor Ledg. Entry".Amount WHERE (Initial Document Type=CONST(Invoice),
                                                                                                                Entry Type=CONST(Initial Entry),
                                                                                                                Vendor No.=FIELD(No.),
                                                                                                                Initial Entry Global Dim. 1=FIELD(Global Dimension 1 Filter),
                                                                                                                Initial Entry Global Dim. 2=FIELD(Global Dimension 2 Filter),
                                                                                                                Posting Date=FIELD(Date Filter),
                                                                                                                Currency Code=FIELD(Currency Filter),
                                                                                                                Fund No.=FIELD(Fund Filter),
                                                                                                                Initial Entry Global Dim. 3=FIELD(Global Dimension 3 Filter),
                                                                                                                Initial Entry Global Dim. 4=FIELD(Global Dimension 4 Filter),
                                                                                                                Initial Entry Global Dim. 5=FIELD(Global Dimension 5 Filter),
                                                                                                                Initial Entry Global Dim. 6=FIELD(Global Dimension 6 Filter),
                                                                                                                Initial Entry Global Dim. 7=FIELD(Global Dimension 7 Filter),
                                                                                                                Initial Entry Global Dim. 8=FIELD(Global Dimension 8 Filter)));
                                                   CaptionML=[ENU=Invoice Amounts;
                                                              ENC=Invoice Amounts];
                                                   Editable=No;
                                                   AutoFormatType=1;
                                                   AutoFormatExpr="Currency Code" }
    { 71  ;   ;Cr. Memo Amounts    ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Detailed Vendor Ledg. Entry".Amount WHERE (Initial Document Type=CONST(Credit Memo),
                                                                                                               Entry Type=CONST(Initial Entry),
                                                                                                               Vendor No.=FIELD(No.),
                                                                                                               Initial Entry Global Dim. 1=FIELD(Global Dimension 1 Filter),
                                                                                                               Initial Entry Global Dim. 2=FIELD(Global Dimension 2 Filter),
                                                                                                               Posting Date=FIELD(Date Filter),
                                                                                                               Currency Code=FIELD(Currency Filter),
                                                                                                               Fund No.=FIELD(Fund Filter),
                                                                                                               Initial Entry Global Dim. 3=FIELD(Global Dimension 3 Filter),
                                                                                                               Initial Entry Global Dim. 4=FIELD(Global Dimension 4 Filter),
                                                                                                               Initial Entry Global Dim. 5=FIELD(Global Dimension 5 Filter),
                                                                                                               Initial Entry Global Dim. 6=FIELD(Global Dimension 6 Filter),
                                                                                                               Initial Entry Global Dim. 7=FIELD(Global Dimension 7 Filter),
                                                                                                               Initial Entry Global Dim. 8=FIELD(Global Dimension 8 Filter)));
                                                   CaptionML=[ENU=Cr. Memo Amounts;
                                                              ENC=Cr. Memo Amounts];
                                                   Editable=No;
                                                   AutoFormatType=1;
                                                   AutoFormatExpr="Currency Code" }
    { 72  ;   ;Finance Charge Memo Amounts;Decimal;FieldClass=FlowField;
                                                   CalcFormula=-Sum("Detailed Vendor Ledg. Entry".Amount WHERE (Initial Document Type=CONST(Finance Charge Memo),
                                                                                                                Entry Type=CONST(Initial Entry),
                                                                                                                Vendor No.=FIELD(No.),
                                                                                                                Initial Entry Global Dim. 1=FIELD(Global Dimension 1 Filter),
                                                                                                                Initial Entry Global Dim. 2=FIELD(Global Dimension 2 Filter),
                                                                                                                Posting Date=FIELD(Date Filter),
                                                                                                                Currency Code=FIELD(Currency Filter),
                                                                                                                Fund No.=FIELD(Fund Filter),
                                                                                                                Initial Entry Global Dim. 3=FIELD(Global Dimension 3 Filter),
                                                                                                                Initial Entry Global Dim. 4=FIELD(Global Dimension 4 Filter),
                                                                                                                Initial Entry Global Dim. 5=FIELD(Global Dimension 5 Filter),
                                                                                                                Initial Entry Global Dim. 6=FIELD(Global Dimension 6 Filter),
                                                                                                                Initial Entry Global Dim. 7=FIELD(Global Dimension 7 Filter),
                                                                                                                Initial Entry Global Dim. 8=FIELD(Global Dimension 8 Filter)));
                                                   CaptionML=[ENU=Finance Charge Memo Amounts;
                                                              ENC=Finance Charge Memo Amounts];
                                                   Editable=No;
                                                   AutoFormatType=1;
                                                   AutoFormatExpr="Currency Code" }
    { 74  ;   ;Payments (LCY)      ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Detailed Vendor Ledg. Entry"."Amount (LCY)" WHERE (Initial Document Type=CONST(Payment),
                                                                                                                       Entry Type=CONST(Initial Entry),
                                                                                                                       Vendor No.=FIELD(No.),
                                                                                                                       Initial Entry Global Dim. 1=FIELD(Global Dimension 1 Filter),
                                                                                                                       Initial Entry Global Dim. 2=FIELD(Global Dimension 2 Filter),
                                                                                                                       Posting Date=FIELD(Date Filter),
                                                                                                                       Currency Code=FIELD(Currency Filter),
                                                                                                                       Fund No.=FIELD(Fund Filter),
                                                                                                                       Initial Entry Global Dim. 3=FIELD(Global Dimension 3 Filter),
                                                                                                                       Initial Entry Global Dim. 4=FIELD(Global Dimension 4 Filter),
                                                                                                                       Initial Entry Global Dim. 5=FIELD(Global Dimension 5 Filter),
                                                                                                                       Initial Entry Global Dim. 6=FIELD(Global Dimension 6 Filter),
                                                                                                                       Initial Entry Global Dim. 7=FIELD(Global Dimension 7 Filter),
                                                                                                                       Initial Entry Global Dim. 8=FIELD(Global Dimension 8 Filter)));
                                                   CaptionML=[ENU=Payments (LCY);
                                                              ENC=Payments (LCY)];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 75  ;   ;Inv. Amounts (LCY)  ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=-Sum("Detailed Vendor Ledg. Entry"."Amount (LCY)" WHERE (Initial Document Type=CONST(Invoice),
                                                                                                                        Entry Type=CONST(Initial Entry),
                                                                                                                        Vendor No.=FIELD(No.),
                                                                                                                        Initial Entry Global Dim. 1=FIELD(Global Dimension 1 Filter),
                                                                                                                        Initial Entry Global Dim. 2=FIELD(Global Dimension 2 Filter),
                                                                                                                        Posting Date=FIELD(Date Filter),
                                                                                                                        Currency Code=FIELD(Currency Filter),
                                                                                                                        Fund No.=FIELD(Fund Filter),
                                                                                                                        Initial Entry Global Dim. 3=FIELD(Global Dimension 3 Filter),
                                                                                                                        Initial Entry Global Dim. 4=FIELD(Global Dimension 4 Filter),
                                                                                                                        Initial Entry Global Dim. 5=FIELD(Global Dimension 5 Filter),
                                                                                                                        Initial Entry Global Dim. 6=FIELD(Global Dimension 6 Filter),
                                                                                                                        Initial Entry Global Dim. 7=FIELD(Global Dimension 7 Filter),
                                                                                                                        Initial Entry Global Dim. 8=FIELD(Global Dimension 8 Filter)));
                                                   CaptionML=[ENU=Inv. Amounts (LCY);
                                                              ENC=Inv. Amounts (LCY)];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 76  ;   ;Cr. Memo Amounts (LCY);Decimal     ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Detailed Vendor Ledg. Entry"."Amount (LCY)" WHERE (Initial Document Type=CONST(Credit Memo),
                                                                                                                       Entry Type=CONST(Initial Entry),
                                                                                                                       Vendor No.=FIELD(No.),
                                                                                                                       Initial Entry Global Dim. 1=FIELD(Global Dimension 1 Filter),
                                                                                                                       Initial Entry Global Dim. 2=FIELD(Global Dimension 2 Filter),
                                                                                                                       Posting Date=FIELD(Date Filter),
                                                                                                                       Currency Code=FIELD(Currency Filter),
                                                                                                                       Fund No.=FIELD(Fund Filter),
                                                                                                                       Initial Entry Global Dim. 3=FIELD(Global Dimension 3 Filter),
                                                                                                                       Initial Entry Global Dim. 4=FIELD(Global Dimension 4 Filter),
                                                                                                                       Initial Entry Global Dim. 5=FIELD(Global Dimension 5 Filter),
                                                                                                                       Initial Entry Global Dim. 6=FIELD(Global Dimension 6 Filter),
                                                                                                                       Initial Entry Global Dim. 7=FIELD(Global Dimension 7 Filter),
                                                                                                                       Initial Entry Global Dim. 8=FIELD(Global Dimension 8 Filter)));
                                                   CaptionML=[ENU=Cr. Memo Amounts (LCY);
                                                              ENC=Cr. Memo Amounts (LCY)];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 77  ;   ;Fin. Charge Memo Amounts (LCY);Decimal;
                                                   FieldClass=FlowField;
                                                   CalcFormula=-Sum("Detailed Vendor Ledg. Entry"."Amount (LCY)" WHERE (Initial Document Type=CONST(Finance Charge Memo),
                                                                                                                        Entry Type=CONST(Initial Entry),
                                                                                                                        Vendor No.=FIELD(No.),
                                                                                                                        Initial Entry Global Dim. 1=FIELD(Global Dimension 1 Filter),
                                                                                                                        Initial Entry Global Dim. 2=FIELD(Global Dimension 2 Filter),
                                                                                                                        Posting Date=FIELD(Date Filter),
                                                                                                                        Currency Code=FIELD(Currency Filter),
                                                                                                                        Fund No.=FIELD(Fund Filter),
                                                                                                                        Initial Entry Global Dim. 3=FIELD(Global Dimension 3 Filter),
                                                                                                                        Initial Entry Global Dim. 4=FIELD(Global Dimension 4 Filter),
                                                                                                                        Initial Entry Global Dim. 5=FIELD(Global Dimension 5 Filter),
                                                                                                                        Initial Entry Global Dim. 6=FIELD(Global Dimension 6 Filter),
                                                                                                                        Initial Entry Global Dim. 7=FIELD(Global Dimension 7 Filter),
                                                                                                                        Initial Entry Global Dim. 8=FIELD(Global Dimension 8 Filter)));
                                                   CaptionML=[ENU=Fin. Charge Memo Amounts (LCY);
                                                              ENC=Fin. Charge Memo Amounts (LCY)];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 78  ;   ;Outstanding Orders  ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Purchase Line"."Outstanding Amount" WHERE (Document Type=CONST(Order),
                                                                                                               Pay-to Vendor No.=FIELD(No.),
                                                                                                               Shortcut Dimension 1 Code=FIELD(Global Dimension 1 Filter),
                                                                                                               Shortcut Dimension 2 Code=FIELD(Global Dimension 2 Filter),
                                                                                                               Currency Code=FIELD(Currency Filter),
                                                                                                               Fund No.=FIELD(Fund Filter),
                                                                                                               Shortcut Dimension 3 Code=FIELD(Global Dimension 3 Filter),
                                                                                                               Shortcut Dimension 4 Code=FIELD(Global Dimension 4 Filter),
                                                                                                               Shortcut Dimension 5 Code=FIELD(Global Dimension 5 Filter),
                                                                                                               Shortcut Dimension 6 Code=FIELD(Global Dimension 6 Filter),
                                                                                                               Shortcut Dimension 7 Code=FIELD(Global Dimension 7 Filter),
                                                                                                               Shortcut Dimension 8 Code=FIELD(Global Dimension 8 Filter)));
                                                   AccessByPermission=TableData 120=R;
                                                   CaptionML=[ENU=Outstanding Orders;
                                                              ENC=Outstanding Orders];
                                                   Editable=No;
                                                   AutoFormatType=1;
                                                   AutoFormatExpr="Currency Code" }
    { 79  ;   ;Amt. Rcd. Not Invoiced;Decimal     ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Purchase Line"."Amt. Rcd. Not Invoiced" WHERE (Document Type=CONST(Order),
                                                                                                                   Pay-to Vendor No.=FIELD(No.),
                                                                                                                   Shortcut Dimension 1 Code=FIELD(Global Dimension 1 Filter),
                                                                                                                   Shortcut Dimension 2 Code=FIELD(Global Dimension 2 Filter),
                                                                                                                   Currency Code=FIELD(Currency Filter),
                                                                                                                   Fund No.=FIELD(Fund Filter),
                                                                                                                   Shortcut Dimension 3 Code=FIELD(Global Dimension 3 Filter),
                                                                                                                   Shortcut Dimension 4 Code=FIELD(Global Dimension 4 Filter),
                                                                                                                   Shortcut Dimension 5 Code=FIELD(Global Dimension 5 Filter),
                                                                                                                   Shortcut Dimension 6 Code=FIELD(Global Dimension 6 Filter),
                                                                                                                   Shortcut Dimension 7 Code=FIELD(Global Dimension 7 Filter),
                                                                                                                   Shortcut Dimension 8 Code=FIELD(Global Dimension 8 Filter)));
                                                   AccessByPermission=TableData 120=R;
                                                   CaptionML=[ENU=Amt. Rcd. Not Invoiced;
                                                              ENC=Amt. Rcd. Not Invoiced];
                                                   Editable=No;
                                                   AutoFormatType=1;
                                                   AutoFormatExpr="Currency Code" }
    { 80  ;   ;Application Method  ;Option        ;CaptionML=[ENU=Application Method;
                                                              ENC=Application Method];
                                                   OptionCaptionML=[ENU=Manual,Apply to Oldest;
                                                                    ENC=Manual,Apply to Oldest];
                                                   OptionString=Manual,Apply to Oldest }
    { 82  ;   ;Prices Including VAT;Boolean       ;OnValidate=VAR
                                                                PurchPrice@1000 : Record 7012;
                                                                Item@1001 : Record 27;
                                                                VATPostingSetup@1002 : Record 325;
                                                                Currency@1003 : Record 4;
                                                              BEGIN
                                                                PurchPrice.SETCURRENTKEY("Vendor No.");
                                                                PurchPrice.SETRANGE("Vendor No.","No.");
                                                                IF PurchPrice.FINDSET(TRUE,FALSE) THEN BEGIN
                                                                  IF VATPostingSetup.GET('','') THEN;
                                                                  IF CONFIRM(
                                                                       STRSUBSTNO(
                                                                         Text002,
                                                                         FIELDCAPTION("Prices Including VAT"),"Prices Including VAT",PurchPrice.TABLECAPTION),TRUE)
                                                                  THEN
                                                                    REPEAT
                                                                      IF PurchPrice."Item No." <> Item."No." THEN
                                                                        Item.GET(PurchPrice."Item No.");
                                                                      IF ("VAT Bus. Posting Group" <> VATPostingSetup."VAT Bus. Posting Group") OR
                                                                         (Item."VAT Prod. Posting Group" <> VATPostingSetup."VAT Prod. Posting Group")
                                                                      THEN
                                                                        VATPostingSetup.GET("VAT Bus. Posting Group",Item."VAT Prod. Posting Group");
                                                                      IF PurchPrice."Currency Code" = '' THEN
                                                                        Currency.InitRoundingPrecision
                                                                      ELSE
                                                                        IF PurchPrice."Currency Code" <> Currency.Code THEN
                                                                          Currency.GET(PurchPrice."Currency Code");
                                                                      IF VATPostingSetup."VAT %" <> 0 THEN BEGIN
                                                                        IF "Prices Including VAT" THEN
                                                                          PurchPrice."Direct Unit Cost" :=
                                                                            ROUND(
                                                                              PurchPrice."Direct Unit Cost" * (1 + VATPostingSetup."VAT %" / 100),
                                                                              Currency."Unit-Amount Rounding Precision")
                                                                        ELSE
                                                                          PurchPrice."Direct Unit Cost" :=
                                                                            ROUND(
                                                                              PurchPrice."Direct Unit Cost" / (1 + VATPostingSetup."VAT %" / 100),
                                                                              Currency."Unit-Amount Rounding Precision");
                                                                        PurchPrice.MODIFY;
                                                                      END;
                                                                    UNTIL PurchPrice.NEXT = 0;
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=Prices Including Tax;
                                                              ENC=Prices Including Tax] }
    { 84  ;   ;Fax No.             ;Text30        ;CaptionML=[ENU=Fax No.;
                                                              ENC=Fax No.] }
    { 85  ;   ;Telex Answer Back   ;Text20        ;CaptionML=[ENU=Telex Answer Back;
                                                              ENC=Telex Answer Back] }
    { 86  ;   ;VAT Registration No.;Text20        ;OnValidate=VAR
                                                                VATRegNoFormat@1000 : Record 381;
                                                                VATRegistrationLogMgt@1002 : Codeunit 249;
                                                              BEGIN
                                                                IF VATRegNoFormat.Test("VAT Registration No.","Country/Region Code","No.",DATABASE::Vendor) THEN
                                                                  IF "VAT Registration No." <> xRec."VAT Registration No." THEN
                                                                    VATRegistrationLogMgt.LogVendor(Rec);
                                                              END;

                                                   CaptionML=[ENU=Tax Registration No.;
                                                              ENC=GST/HST Registration No.] }
    { 88  ;   ;Gen. Bus. Posting Group;Code10     ;TableRelation="Gen. Business Posting Group";
                                                   OnValidate=BEGIN
                                                                IF xRec."Gen. Bus. Posting Group" <> "Gen. Bus. Posting Group" THEN
                                                                  IF GenBusPostingGrp.ValidateVatBusPostingGroup(GenBusPostingGrp,"Gen. Bus. Posting Group") THEN
                                                                    VALIDATE("VAT Bus. Posting Group",GenBusPostingGrp."Def. VAT Bus. Posting Group");
                                                              END;

                                                   CaptionML=[ENU=Gen. Bus. Posting Group;
                                                              ENC=Gen. Bus. Posting Group] }
    { 89  ;   ;Picture             ;BLOB          ;CaptionML=[ENU=Picture;
                                                              ENC=Picture];
                                                   SubType=Bitmap }
    { 90  ;   ;GLN                 ;Code13        ;OnValidate=VAR
                                                                GLNCalculator@1000 : Codeunit 1607;
                                                              BEGIN
                                                                IF GLN <> '' THEN
                                                                  GLNCalculator.AssertValidCheckDigit13(GLN);
                                                              END;

                                                   CaptionML=[ENU=GLN;
                                                              ENC=GLN];
                                                   Numeric=Yes }
    { 91  ;   ;Post Code           ;Code20        ;TableRelation=IF (Country/Region Code=CONST()) "Post Code"
                                                                 ELSE IF (Country/Region Code=FILTER(<>'')) "Post Code" WHERE (Country/Region Code=FIELD(Country/Region Code));
                                                   OnValidate=BEGIN
                                                                PostCode.ValidatePostCode(City,"Post Code",County,"Country/Region Code",(CurrFieldNo <> 0) AND GUIALLOWED);
                                                              END;

                                                   ValidateTableRelation=No;
                                                   TestTableRelation=No;
                                                   CaptionML=[ENU=ZIP Code;
                                                              ENC=Postal/ZIP Code] }
    { 92  ;   ;County              ;Text30        ;CaptionML=[ENU=State;
                                                              ENC=Province/State] }
    { 97  ;   ;Debit Amount        ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Detailed Vendor Ledg. Entry"."Debit Amount" WHERE (Vendor No.=FIELD(No.),
                                                                                                                       Entry Type=FILTER(<>Application),
                                                                                                                       Initial Entry Global Dim. 1=FIELD(Global Dimension 1 Filter),
                                                                                                                       Initial Entry Global Dim. 2=FIELD(Global Dimension 2 Filter),
                                                                                                                       Posting Date=FIELD(Date Filter),
                                                                                                                       Currency Code=FIELD(Currency Filter),
                                                                                                                       Fund No.=FIELD(Fund Filter),
                                                                                                                       Initial Entry Global Dim. 3=FIELD(Global Dimension 3 Filter),
                                                                                                                       Initial Entry Global Dim. 4=FIELD(Global Dimension 4 Filter),
                                                                                                                       Initial Entry Global Dim. 5=FIELD(Global Dimension 5 Filter),
                                                                                                                       Initial Entry Global Dim. 6=FIELD(Global Dimension 6 Filter),
                                                                                                                       Initial Entry Global Dim. 7=FIELD(Global Dimension 7 Filter),
                                                                                                                       Initial Entry Global Dim. 8=FIELD(Global Dimension 8 Filter)));
                                                   CaptionML=[ENU=Debit Amount;
                                                              ENC=Debit Amount];
                                                   BlankZero=Yes;
                                                   Editable=No;
                                                   AutoFormatType=1;
                                                   AutoFormatExpr="Currency Code" }
    { 98  ;   ;Credit Amount       ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Detailed Vendor Ledg. Entry"."Credit Amount" WHERE (Vendor No.=FIELD(No.),
                                                                                                                        Entry Type=FILTER(<>Application),
                                                                                                                        Initial Entry Global Dim. 1=FIELD(Global Dimension 1 Filter),
                                                                                                                        Initial Entry Global Dim. 2=FIELD(Global Dimension 2 Filter),
                                                                                                                        Posting Date=FIELD(Date Filter),
                                                                                                                        Currency Code=FIELD(Currency Filter),
                                                                                                                        Fund No.=FIELD(Fund Filter),
                                                                                                                        Initial Entry Global Dim. 3=FIELD(Global Dimension 3 Filter),
                                                                                                                        Initial Entry Global Dim. 4=FIELD(Global Dimension 4 Filter),
                                                                                                                        Initial Entry Global Dim. 5=FIELD(Global Dimension 5 Filter),
                                                                                                                        Initial Entry Global Dim. 6=FIELD(Global Dimension 6 Filter),
                                                                                                                        Initial Entry Global Dim. 7=FIELD(Global Dimension 7 Filter),
                                                                                                                        Initial Entry Global Dim. 8=FIELD(Global Dimension 8 Filter)));
                                                   CaptionML=[ENU=Credit Amount;
                                                              ENC=Credit Amount];
                                                   BlankZero=Yes;
                                                   Editable=No;
                                                   AutoFormatType=1;
                                                   AutoFormatExpr="Currency Code" }
    { 99  ;   ;Debit Amount (LCY)  ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Detailed Vendor Ledg. Entry"."Debit Amount (LCY)" WHERE (Vendor No.=FIELD(No.),
                                                                                                                             Entry Type=FILTER(<>Application),
                                                                                                                             Initial Entry Global Dim. 1=FIELD(Global Dimension 1 Filter),
                                                                                                                             Initial Entry Global Dim. 2=FIELD(Global Dimension 2 Filter),
                                                                                                                             Posting Date=FIELD(Date Filter),
                                                                                                                             Currency Code=FIELD(Currency Filter),
                                                                                                                             Fund No.=FIELD(Fund Filter),
                                                                                                                             Initial Entry Global Dim. 3=FIELD(Global Dimension 3 Filter),
                                                                                                                             Initial Entry Global Dim. 4=FIELD(Global Dimension 4 Filter),
                                                                                                                             Initial Entry Global Dim. 5=FIELD(Global Dimension 5 Filter),
                                                                                                                             Initial Entry Global Dim. 6=FIELD(Global Dimension 6 Filter),
                                                                                                                             Initial Entry Global Dim. 7=FIELD(Global Dimension 7 Filter),
                                                                                                                             Initial Entry Global Dim. 8=FIELD(Global Dimension 8 Filter)));
                                                   CaptionML=[ENU=Debit Amount (LCY);
                                                              ENC=Debit Amount (LCY)];
                                                   BlankZero=Yes;
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 100 ;   ;Credit Amount (LCY) ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Detailed Vendor Ledg. Entry"."Credit Amount (LCY)" WHERE (Vendor No.=FIELD(No.),
                                                                                                                              Entry Type=FILTER(<>Application),
                                                                                                                              Initial Entry Global Dim. 1=FIELD(Global Dimension 1 Filter),
                                                                                                                              Initial Entry Global Dim. 2=FIELD(Global Dimension 2 Filter),
                                                                                                                              Posting Date=FIELD(Date Filter),
                                                                                                                              Currency Code=FIELD(Currency Filter),
                                                                                                                              Fund No.=FIELD(Fund Filter),
                                                                                                                              Initial Entry Global Dim. 3=FIELD(Global Dimension 3 Filter),
                                                                                                                              Initial Entry Global Dim. 4=FIELD(Global Dimension 4 Filter),
                                                                                                                              Initial Entry Global Dim. 5=FIELD(Global Dimension 5 Filter),
                                                                                                                              Initial Entry Global Dim. 6=FIELD(Global Dimension 6 Filter),
                                                                                                                              Initial Entry Global Dim. 7=FIELD(Global Dimension 7 Filter),
                                                                                                                              Initial Entry Global Dim. 8=FIELD(Global Dimension 8 Filter)));
                                                   CaptionML=[ENU=Credit Amount (LCY);
                                                              ENC=Credit Amount (LCY)];
                                                   BlankZero=Yes;
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 102 ;   ;E-Mail              ;Text80        ;ExtendedDatatype=E-Mail;
                                                   CaptionML=[ENU=Email;
                                                              ENC=Email] }
    { 103 ;   ;Home Page           ;Text80        ;ExtendedDatatype=URL;
                                                   CaptionML=[ENU=Home Page;
                                                              ENC=Home Page] }
    { 104 ;   ;Reminder Amounts    ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=-Sum("Detailed Vendor Ledg. Entry".Amount WHERE (Initial Document Type=CONST(Reminder),
                                                                                                                Entry Type=CONST(Initial Entry),
                                                                                                                Vendor No.=FIELD(No.),
                                                                                                                Initial Entry Global Dim. 1=FIELD(Global Dimension 1 Filter),
                                                                                                                Initial Entry Global Dim. 2=FIELD(Global Dimension 2 Filter),
                                                                                                                Posting Date=FIELD(Date Filter),
                                                                                                                Currency Code=FIELD(Currency Filter),
                                                                                                                Fund No.=FIELD(Fund Filter),
                                                                                                                Initial Entry Global Dim. 3=FIELD(Global Dimension 3 Filter),
                                                                                                                Initial Entry Global Dim. 4=FIELD(Global Dimension 4 Filter),
                                                                                                                Initial Entry Global Dim. 5=FIELD(Global Dimension 5 Filter),
                                                                                                                Initial Entry Global Dim. 6=FIELD(Global Dimension 6 Filter),
                                                                                                                Initial Entry Global Dim. 7=FIELD(Global Dimension 7 Filter),
                                                                                                                Initial Entry Global Dim. 8=FIELD(Global Dimension 8 Filter)));
                                                   CaptionML=[ENU=Reminder Amounts;
                                                              ENC=Reminder Amounts];
                                                   Editable=No;
                                                   AutoFormatType=1;
                                                   AutoFormatExpr="Currency Code" }
    { 105 ;   ;Reminder Amounts (LCY);Decimal     ;FieldClass=FlowField;
                                                   CalcFormula=-Sum("Detailed Vendor Ledg. Entry"."Amount (LCY)" WHERE (Initial Document Type=CONST(Reminder),
                                                                                                                        Entry Type=CONST(Initial Entry),
                                                                                                                        Vendor No.=FIELD(No.),
                                                                                                                        Initial Entry Global Dim. 1=FIELD(Global Dimension 1 Filter),
                                                                                                                        Initial Entry Global Dim. 2=FIELD(Global Dimension 2 Filter),
                                                                                                                        Posting Date=FIELD(Date Filter),
                                                                                                                        Currency Code=FIELD(Currency Filter),
                                                                                                                        Fund No.=FIELD(Fund Filter),
                                                                                                                        Initial Entry Global Dim. 3=FIELD(Global Dimension 3 Filter),
                                                                                                                        Initial Entry Global Dim. 4=FIELD(Global Dimension 4 Filter),
                                                                                                                        Initial Entry Global Dim. 5=FIELD(Global Dimension 5 Filter),
                                                                                                                        Initial Entry Global Dim. 6=FIELD(Global Dimension 6 Filter),
                                                                                                                        Initial Entry Global Dim. 7=FIELD(Global Dimension 7 Filter),
                                                                                                                        Initial Entry Global Dim. 8=FIELD(Global Dimension 8 Filter)));
                                                   CaptionML=[ENU=Reminder Amounts (LCY);
                                                              ENC=Reminder Amounts (LCY)];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 107 ;   ;No. Series          ;Code10        ;TableRelation="No. Series";
                                                   CaptionML=[ENU=No. Series;
                                                              ENC=No. Series];
                                                   Editable=No }
    { 108 ;   ;Tax Area Code       ;Code20        ;TableRelation="Tax Area";
                                                   CaptionML=[ENU=Tax Area Code;
                                                              ENC=Tax Area Code] }
    { 109 ;   ;Tax Liable          ;Boolean       ;CaptionML=[ENU=Tax Liable;
                                                              ENC=Tax Liable] }
    { 110 ;   ;VAT Bus. Posting Group;Code10      ;TableRelation="VAT Business Posting Group";
                                                   CaptionML=[ENU=Tax Bus. Posting Group;
                                                              ENC=Tax Bus. Posting Group] }
    { 111 ;   ;Currency Filter     ;Code10        ;FieldClass=FlowFilter;
                                                   TableRelation=Currency;
                                                   CaptionML=[ENU=Currency Filter;
                                                              ENC=Currency Filter] }
    { 113 ;   ;Outstanding Orders (LCY);Decimal   ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Purchase Line"."Outstanding Amount (LCY)" WHERE (Document Type=CONST(Order),
                                                                                                                     Pay-to Vendor No.=FIELD(No.),
                                                                                                                     Shortcut Dimension 1 Code=FIELD(Global Dimension 1 Filter),
                                                                                                                     Shortcut Dimension 2 Code=FIELD(Global Dimension 2 Filter),
                                                                                                                     Currency Code=FIELD(Currency Filter),
                                                                                                                     Fund No.=FIELD(Fund Filter),
                                                                                                                     Shortcut Dimension 3 Code=FIELD(Global Dimension 3 Filter),
                                                                                                                     Shortcut Dimension 4 Code=FIELD(Global Dimension 4 Filter),
                                                                                                                     Shortcut Dimension 5 Code=FIELD(Global Dimension 5 Filter),
                                                                                                                     Shortcut Dimension 6 Code=FIELD(Global Dimension 6 Filter),
                                                                                                                     Shortcut Dimension 7 Code=FIELD(Global Dimension 7 Filter),
                                                                                                                     Shortcut Dimension 8 Code=FIELD(Global Dimension 8 Filter)));
                                                   AccessByPermission=TableData 120=R;
                                                   CaptionML=[ENU=Outstanding Orders (LCY);
                                                              ENC=Outstanding Orders (LCY)];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 114 ;   ;Amt. Rcd. Not Invoiced (LCY);Decimal;
                                                   FieldClass=FlowField;
                                                   CalcFormula=Sum("Purchase Line"."Amt. Rcd. Not Invoiced (LCY)" WHERE (Document Type=CONST(Order),
                                                                                                                         Pay-to Vendor No.=FIELD(No.),
                                                                                                                         Shortcut Dimension 1 Code=FIELD(Global Dimension 1 Filter),
                                                                                                                         Shortcut Dimension 2 Code=FIELD(Global Dimension 2 Filter),
                                                                                                                         Currency Code=FIELD(Currency Filter),
                                                                                                                         Fund No.=FIELD(Fund Filter),
                                                                                                                         Shortcut Dimension 3 Code=FIELD(Global Dimension 3 Filter),
                                                                                                                         Shortcut Dimension 4 Code=FIELD(Global Dimension 4 Filter),
                                                                                                                         Shortcut Dimension 5 Code=FIELD(Global Dimension 5 Filter),
                                                                                                                         Shortcut Dimension 6 Code=FIELD(Global Dimension 6 Filter),
                                                                                                                         Shortcut Dimension 7 Code=FIELD(Global Dimension 7 Filter),
                                                                                                                         Shortcut Dimension 8 Code=FIELD(Global Dimension 8 Filter)));
                                                   AccessByPermission=TableData 120=R;
                                                   CaptionML=[ENU=Amt. Rcd. Not Invoiced (LCY);
                                                              ENC=Amt. Rcd. Not Invoiced (LCY)];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 116 ;   ;Block Payment Tolerance;Boolean    ;CaptionML=[ENU=Block Payment Tolerance;
                                                              ENC=Block Payment Tolerance] }
    { 117 ;   ;Pmt. Disc. Tolerance (LCY);Decimal ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Detailed Vendor Ledg. Entry"."Amount (LCY)" WHERE (Vendor No.=FIELD(No.),
                                                                                                                       Entry Type=FILTER('Payment Tolerance (VAT Excl.)'|'Payment Discount Tolerance (VAT Adjustment)'|'Payment Discount Tolerance (VAT Adjustment)'),
                                                                                                                       Initial Entry Global Dim. 1=FIELD(Global Dimension 1 Filter),
                                                                                                                       Initial Entry Global Dim. 2=FIELD(Global Dimension 2 Filter),
                                                                                                                       Posting Date=FIELD(Date Filter),
                                                                                                                       Currency Code=FIELD(Currency Filter),
                                                                                                                       Fund No.=FIELD(Fund Filter),
                                                                                                                       Initial Entry Global Dim. 3=FIELD(Global Dimension 3 Filter),
                                                                                                                       Initial Entry Global Dim. 4=FIELD(Global Dimension 4 Filter),
                                                                                                                       Initial Entry Global Dim. 5=FIELD(Global Dimension 5 Filter),
                                                                                                                       Initial Entry Global Dim. 6=FIELD(Global Dimension 6 Filter),
                                                                                                                       Initial Entry Global Dim. 7=FIELD(Global Dimension 7 Filter),
                                                                                                                       Initial Entry Global Dim. 8=FIELD(Global Dimension 8 Filter)));
                                                   CaptionML=[ENU=Pmt. Disc. Tolerance (LCY);
                                                              ENC=Pmt. Disc. Tolerance (LCY)];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 118 ;   ;Pmt. Tolerance (LCY);Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Detailed Vendor Ledg. Entry"."Amount (LCY)" WHERE (Vendor No.=FIELD(No.),
                                                                                                                       Entry Type=FILTER(Payment Tolerance|'Payment Discount Tolerance (VAT Excl.)'|'Payment Tolerance (VAT Adjustment)'),
                                                                                                                       Initial Entry Global Dim. 1=FIELD(Global Dimension 1 Filter),
                                                                                                                       Initial Entry Global Dim. 2=FIELD(Global Dimension 2 Filter),
                                                                                                                       Posting Date=FIELD(Date Filter),
                                                                                                                       Currency Code=FIELD(Currency Filter),
                                                                                                                       Fund No.=FIELD(Fund Filter),
                                                                                                                       Initial Entry Global Dim. 3=FIELD(Global Dimension 3 Filter),
                                                                                                                       Initial Entry Global Dim. 4=FIELD(Global Dimension 4 Filter),
                                                                                                                       Initial Entry Global Dim. 5=FIELD(Global Dimension 5 Filter),
                                                                                                                       Initial Entry Global Dim. 6=FIELD(Global Dimension 6 Filter),
                                                                                                                       Initial Entry Global Dim. 7=FIELD(Global Dimension 7 Filter),
                                                                                                                       Initial Entry Global Dim. 8=FIELD(Global Dimension 8 Filter)));
                                                   CaptionML=[ENU=Pmt. Tolerance (LCY);
                                                              ENC=Pmt. Tolerance (LCY)];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 119 ;   ;IC Partner Code     ;Code20        ;TableRelation="IC Partner";
                                                   OnValidate=VAR
                                                                VendLedgEntry@1001 : Record 25;
                                                                AccountingPeriod@1000 : Record 50;
                                                                ICPartner@1002 : Record 413;
                                                              BEGIN
                                                                IF xRec."IC Partner Code" <> "IC Partner Code" THEN BEGIN
                                                                  IF NOT VendLedgEntry.SETCURRENTKEY("Vendor No.",Open) THEN
                                                                    VendLedgEntry.SETCURRENTKEY("Vendor No.");
                                                                  VendLedgEntry.SETRANGE("Vendor No.","No.");
                                                                  VendLedgEntry.SETRANGE(Open,TRUE);
                                                                  IF VendLedgEntry.FINDLAST THEN
                                                                    ERROR(Text010,FIELDCAPTION("IC Partner Code"),TABLECAPTION);

                                                                  VendLedgEntry.RESET;
                                                                  VendLedgEntry.SETCURRENTKEY("Vendor No.","Posting Date");
                                                                  VendLedgEntry.SETRANGE("Vendor No.","No.");
                                                                  AccountingPeriod.SETRANGE(Closed,FALSE);
                                                                  IF AccountingPeriod.FINDFIRST THEN BEGIN
                                                                    VendLedgEntry.SETFILTER("Posting Date",'>=%1',AccountingPeriod."Starting Date");
                                                                    IF VendLedgEntry.FINDFIRST THEN
                                                                      IF NOT CONFIRM(Text009,FALSE,TABLECAPTION) THEN
                                                                        "IC Partner Code" := xRec."IC Partner Code";
                                                                  END;
                                                                END;

                                                                IF "IC Partner Code" <> '' THEN BEGIN
                                                                  ICPartner.GET("IC Partner Code");
                                                                  IF (ICPartner."Vendor No." <> '') AND (ICPartner."Vendor No." <> "No.") THEN
                                                                    ERROR(Text008,FIELDCAPTION("IC Partner Code"),"IC Partner Code",TABLECAPTION,ICPartner."Vendor No.");
                                                                  ICPartner."Vendor No." := "No.";
                                                                  ICPartner.MODIFY;
                                                                END;

                                                                IF (xRec."IC Partner Code" <> "IC Partner Code") AND ICPartner.GET(xRec."IC Partner Code") THEN BEGIN
                                                                  ICPartner."Vendor No." := '';
                                                                  ICPartner.MODIFY;
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=IC Partner Code;
                                                              ENC=IC Partner Code] }
    { 120 ;   ;Refunds             ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=-Sum("Detailed Vendor Ledg. Entry".Amount WHERE (Initial Document Type=CONST(Refund),
                                                                                                                Entry Type=CONST(Initial Entry),
                                                                                                                Vendor No.=FIELD(No.),
                                                                                                                Initial Entry Global Dim. 1=FIELD(Global Dimension 1 Filter),
                                                                                                                Initial Entry Global Dim. 2=FIELD(Global Dimension 2 Filter),
                                                                                                                Posting Date=FIELD(Date Filter),
                                                                                                                Currency Code=FIELD(Currency Filter),
                                                                                                                Fund No.=FIELD(Fund Filter),
                                                                                                                Initial Entry Global Dim. 3=FIELD(Global Dimension 3 Filter),
                                                                                                                Initial Entry Global Dim. 4=FIELD(Global Dimension 4 Filter),
                                                                                                                Initial Entry Global Dim. 5=FIELD(Global Dimension 5 Filter),
                                                                                                                Initial Entry Global Dim. 6=FIELD(Global Dimension 6 Filter),
                                                                                                                Initial Entry Global Dim. 7=FIELD(Global Dimension 7 Filter),
                                                                                                                Initial Entry Global Dim. 8=FIELD(Global Dimension 8 Filter)));
                                                   CaptionML=[ENU=Refunds;
                                                              ENC=Refunds] }
    { 121 ;   ;Refunds (LCY)       ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=-Sum("Detailed Vendor Ledg. Entry"."Amount (LCY)" WHERE (Initial Document Type=CONST(Refund),
                                                                                                                        Entry Type=CONST(Initial Entry),
                                                                                                                        Vendor No.=FIELD(No.),
                                                                                                                        Initial Entry Global Dim. 1=FIELD(Global Dimension 1 Filter),
                                                                                                                        Initial Entry Global Dim. 2=FIELD(Global Dimension 2 Filter),
                                                                                                                        Posting Date=FIELD(Date Filter),
                                                                                                                        Currency Code=FIELD(Currency Filter),
                                                                                                                        Fund No.=FIELD(Fund Filter),
                                                                                                                        Initial Entry Global Dim. 3=FIELD(Global Dimension 3 Filter),
                                                                                                                        Initial Entry Global Dim. 4=FIELD(Global Dimension 4 Filter),
                                                                                                                        Initial Entry Global Dim. 5=FIELD(Global Dimension 5 Filter),
                                                                                                                        Initial Entry Global Dim. 6=FIELD(Global Dimension 6 Filter),
                                                                                                                        Initial Entry Global Dim. 7=FIELD(Global Dimension 7 Filter),
                                                                                                                        Initial Entry Global Dim. 8=FIELD(Global Dimension 8 Filter)));
                                                   CaptionML=[ENU=Refunds (LCY);
                                                              ENC=Refunds (LCY)] }
    { 122 ;   ;Other Amounts       ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=-Sum("Detailed Vendor Ledg. Entry".Amount WHERE (Initial Document Type=CONST(" "),
                                                                                                                Entry Type=CONST(Initial Entry),
                                                                                                                Vendor No.=FIELD(No.),
                                                                                                                Initial Entry Global Dim. 1=FIELD(Global Dimension 1 Filter),
                                                                                                                Initial Entry Global Dim. 2=FIELD(Global Dimension 2 Filter),
                                                                                                                Posting Date=FIELD(Date Filter),
                                                                                                                Currency Code=FIELD(Currency Filter),
                                                                                                                Fund No.=FIELD(Fund Filter),
                                                                                                                Initial Entry Global Dim. 3=FIELD(Global Dimension 3 Filter),
                                                                                                                Initial Entry Global Dim. 4=FIELD(Global Dimension 4 Filter),
                                                                                                                Initial Entry Global Dim. 5=FIELD(Global Dimension 5 Filter),
                                                                                                                Initial Entry Global Dim. 6=FIELD(Global Dimension 6 Filter),
                                                                                                                Initial Entry Global Dim. 7=FIELD(Global Dimension 7 Filter),
                                                                                                                Initial Entry Global Dim. 8=FIELD(Global Dimension 8 Filter)));
                                                   CaptionML=[ENU=Other Amounts;
                                                              ENC=Other Amounts] }
    { 123 ;   ;Other Amounts (LCY) ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=-Sum("Detailed Vendor Ledg. Entry"."Amount (LCY)" WHERE (Initial Document Type=CONST(" "),
                                                                                                                        Entry Type=CONST(Initial Entry),
                                                                                                                        Vendor No.=FIELD(No.),
                                                                                                                        Initial Entry Global Dim. 1=FIELD(Global Dimension 1 Filter),
                                                                                                                        Initial Entry Global Dim. 2=FIELD(Global Dimension 2 Filter),
                                                                                                                        Posting Date=FIELD(Date Filter),
                                                                                                                        Currency Code=FIELD(Currency Filter),
                                                                                                                        Fund No.=FIELD(Fund Filter),
                                                                                                                        Initial Entry Global Dim. 3=FIELD(Global Dimension 3 Filter),
                                                                                                                        Initial Entry Global Dim. 4=FIELD(Global Dimension 4 Filter),
                                                                                                                        Initial Entry Global Dim. 5=FIELD(Global Dimension 5 Filter),
                                                                                                                        Initial Entry Global Dim. 6=FIELD(Global Dimension 6 Filter),
                                                                                                                        Initial Entry Global Dim. 7=FIELD(Global Dimension 7 Filter),
                                                                                                                        Initial Entry Global Dim. 8=FIELD(Global Dimension 8 Filter)));
                                                   CaptionML=[ENU=Other Amounts (LCY);
                                                              ENC=Other Amounts (LCY)] }
    { 124 ;   ;Prepayment %        ;Decimal       ;CaptionML=[ENU=Prepayment %;
                                                              ENC=Prepayment %];
                                                   DecimalPlaces=0:5;
                                                   MinValue=0;
                                                   MaxValue=100 }
    { 125 ;   ;Outstanding Invoices;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Purchase Line"."Outstanding Amount" WHERE (Document Type=CONST(Invoice),
                                                                                                               Pay-to Vendor No.=FIELD(No.),
                                                                                                               Shortcut Dimension 1 Code=FIELD(Global Dimension 1 Filter),
                                                                                                               Shortcut Dimension 2 Code=FIELD(Global Dimension 2 Filter),
                                                                                                               Currency Code=FIELD(Currency Filter)));
                                                   AccessByPermission=TableData 120=R;
                                                   CaptionML=[ENU=Outstanding Invoices;
                                                              ENC=Outstanding Invoices];
                                                   Editable=No;
                                                   AutoFormatType=1;
                                                   AutoFormatExpr="Currency Code" }
    { 126 ;   ;Outstanding Invoices (LCY);Decimal ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Purchase Line"."Outstanding Amount (LCY)" WHERE (Document Type=CONST(Invoice),
                                                                                                                     Pay-to Vendor No.=FIELD(No.),
                                                                                                                     Shortcut Dimension 1 Code=FIELD(Global Dimension 1 Filter),
                                                                                                                     Shortcut Dimension 2 Code=FIELD(Global Dimension 2 Filter),
                                                                                                                     Currency Code=FIELD(Currency Filter)));
                                                   AccessByPermission=TableData 120=R;
                                                   CaptionML=[ENU=Outstanding Invoices (LCY);
                                                              ENC=Outstanding Invoices (LCY)];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 130 ;   ;Pay-to No. Of Archived Doc.;Integer;FieldClass=FlowField;
                                                   CalcFormula=Count("Purchase Header Archive" WHERE (Document Type=CONST(Order),
                                                                                                      Pay-to Vendor No.=FIELD(No.)));
                                                   CaptionML=[ENU=Pay-to No. Of Archived Doc.;
                                                              ENC=No. Of Archived Doc.] }
    { 131 ;   ;Buy-from No. Of Archived Doc.;Integer;
                                                   FieldClass=FlowField;
                                                   CalcFormula=Count("Purchase Header Archive" WHERE (Document Type=CONST(Order),
                                                                                                      Buy-from Vendor No.=FIELD(No.)));
                                                   CaptionML=[ENU=Buy-from No. Of Archived Doc.;
                                                              ENC=Buy-from No. Of Archived Doc.] }
    { 132 ;   ;Partner Type        ;Option        ;CaptionML=[ENU=Partner Type;
                                                              ENC=Partner Type];
                                                   OptionCaptionML=[ENU=" ,Company,Person";
                                                                    ENC=" ,Company,Person"];
                                                   OptionString=[ ,Company,Person] }
    { 140 ;   ;Image               ;Media         ;ExtendedDatatype=Person;
                                                   CaptionML=[ENU=Image;
                                                              ENC=Image] }
    { 170 ;   ;Creditor No.        ;Code20        ;CaptionML=[ENU=Creditor No.;
                                                              ENC=Creditor No.];
                                                   Numeric=Yes }
    { 288 ;   ;Preferred Bank Account Code;Code10 ;TableRelation="Vendor Bank Account".Code WHERE (Vendor No.=FIELD(No.));
                                                   CaptionML=[ENU=Preferred Bank Account Code;
                                                              ENC=Preferred Bank Account Code] }
    { 840 ;   ;Cash Flow Payment Terms Code;Code10;TableRelation="Payment Terms";
                                                   CaptionML=[ENU=Cash Flow Payment Terms Code;
                                                              ENC=Cash Flow Payment Terms Code] }
    { 5049;   ;Primary Contact No. ;Code20        ;TableRelation=Contact;
                                                   OnValidate=VAR
                                                                Cont@1001 : Record 5050;
                                                                ContBusRel@1000 : Record 5054;
                                                              BEGIN
                                                                Contact := '';
                                                                IF "Primary Contact No." <> '' THEN BEGIN
                                                                  Cont.GET("Primary Contact No.");

                                                                  ContBusRel.SETCURRENTKEY("Link to Table","No.");
                                                                  ContBusRel.SETRANGE("Link to Table",ContBusRel."Link to Table"::Vendor);
                                                                  ContBusRel.SETRANGE("No.","No.");
                                                                  ContBusRel.FINDFIRST;

                                                                  IF Cont."Company No." <> ContBusRel."Contact No." THEN
                                                                    ERROR(Text004,Cont."No.",Cont.Name,"No.",Name);

                                                                  IF Cont.Type = Cont.Type::Person THEN
                                                                    Contact := Cont.Name
                                                                END;
                                                              END;

                                                   OnLookup=VAR
                                                              Cont@1001 : Record 5050;
                                                              ContBusRel@1000 : Record 5054;
                                                              TempVend@1002 : TEMPORARY Record 23;
                                                            BEGIN
                                                              ContBusRel.SETCURRENTKEY("Link to Table","No.");
                                                              ContBusRel.SETRANGE("Link to Table",ContBusRel."Link to Table"::Vendor);
                                                              ContBusRel.SETRANGE("No.","No.");
                                                              IF ContBusRel.FINDFIRST THEN
                                                                Cont.SETRANGE("Company No.",ContBusRel."Contact No.")
                                                              ELSE
                                                                Cont.SETRANGE("No.",'');

                                                              IF "Primary Contact No." <> '' THEN
                                                                IF Cont.GET("Primary Contact No.") THEN ;
                                                              IF PAGE.RUNMODAL(0,Cont) = ACTION::LookupOK THEN BEGIN
                                                                TempVend.COPY(Rec);
                                                                FIND;
                                                                TRANSFERFIELDS(TempVend,FALSE);
                                                                VALIDATE("Primary Contact No.",Cont."No.");
                                                              END;
                                                            END;

                                                   CaptionML=[ENU=Primary Contact No.;
                                                              ENC=Primary Contact No.] }
    { 5700;   ;Responsibility Center;Code10       ;TableRelation="Responsibility Center";
                                                   CaptionML=[ENU=Responsibility Center;
                                                              ENC=Responsibility Centre] }
    { 5701;   ;Location Code       ;Code10        ;TableRelation=Location WHERE (Use As In-Transit=CONST(No));
                                                   CaptionML=[ENU=Location Code;
                                                              ENC=Location Code] }
    { 5790;   ;Lead Time Calculation;DateFormula  ;AccessByPermission=TableData 120=R;
                                                   CaptionML=[ENU=Lead Time Calculation;
                                                              ENC=Lead Time Calculation] }
    { 7177;   ;No. of Pstd. Receipts;Integer      ;FieldClass=FlowField;
                                                   CalcFormula=Count("Purch. Rcpt. Header" WHERE (Buy-from Vendor No.=FIELD(No.)));
                                                   CaptionML=[ENU=No. of Pstd. Receipts;
                                                              ENC=No. of Pstd. Receipts];
                                                   Editable=No }
    { 7178;   ;No. of Pstd. Invoices;Integer      ;FieldClass=FlowField;
                                                   CalcFormula=Count("Purch. Inv. Header" WHERE (Buy-from Vendor No.=FIELD(No.)));
                                                   CaptionML=[ENU=No. of Pstd. Invoices;
                                                              ENC=No. of Pstd. Invoices];
                                                   Editable=No }
    { 7179;   ;No. of Pstd. Return Shipments;Integer;
                                                   FieldClass=FlowField;
                                                   CalcFormula=Count("Return Shipment Header" WHERE (Buy-from Vendor No.=FIELD(No.)));
                                                   CaptionML=[ENU=No. of Pstd. Return Shipments;
                                                              ENC=No. of Pstd. Return Shipments];
                                                   Editable=No }
    { 7180;   ;No. of Pstd. Credit Memos;Integer  ;FieldClass=FlowField;
                                                   CalcFormula=Count("Purch. Cr. Memo Hdr." WHERE (Buy-from Vendor No.=FIELD(No.)));
                                                   CaptionML=[ENU=No. of Pstd. Credit Memos;
                                                              ENC=No. of Pstd. Credit Memos];
                                                   Editable=No }
    { 7181;   ;Pay-to No. of Orders;Integer       ;FieldClass=FlowField;
                                                   CalcFormula=Count("Purchase Header" WHERE (Document Type=CONST(Order),
                                                                                              Pay-to Vendor No.=FIELD(No.)));
                                                   AccessByPermission=TableData 120=R;
                                                   CaptionML=[ENU=Pay-to No. of Orders;
                                                              ENC=Pay-to No. of Orders];
                                                   Editable=No }
    { 7182;   ;Pay-to No. of Invoices;Integer     ;FieldClass=FlowField;
                                                   CalcFormula=Count("Purchase Header" WHERE (Document Type=CONST(Invoice),
                                                                                              Pay-to Vendor No.=FIELD(No.)));
                                                   CaptionML=[ENU=Pay-to No. of Invoices;
                                                              ENC=Pay-to No. of Invoices];
                                                   Editable=No }
    { 7183;   ;Pay-to No. of Return Orders;Integer;FieldClass=FlowField;
                                                   CalcFormula=Count("Purchase Header" WHERE (Document Type=CONST(Return Order),
                                                                                              Pay-to Vendor No.=FIELD(No.)));
                                                   AccessByPermission=TableData 6650=R;
                                                   CaptionML=[ENU=Pay-to No. of Return Orders;
                                                              ENC=Pay-to No. of Return Orders];
                                                   Editable=No }
    { 7184;   ;Pay-to No. of Credit Memos;Integer ;FieldClass=FlowField;
                                                   CalcFormula=Count("Purchase Header" WHERE (Document Type=CONST(Credit Memo),
                                                                                              Pay-to Vendor No.=FIELD(No.)));
                                                   CaptionML=[ENU=Pay-to No. of Credit Memos;
                                                              ENC=Pay-to No. of Credit Memos];
                                                   Editable=No }
    { 7185;   ;Pay-to No. of Pstd. Receipts;Integer;
                                                   FieldClass=FlowField;
                                                   CalcFormula=Count("Purch. Rcpt. Header" WHERE (Pay-to Vendor No.=FIELD(No.)));
                                                   CaptionML=[ENU=Pay-to No. of Pstd. Receipts;
                                                              ENC=Pay-to No. of Pstd. Receipts];
                                                   Editable=No }
    { 7186;   ;Pay-to No. of Pstd. Invoices;Integer;
                                                   FieldClass=FlowField;
                                                   CalcFormula=Count("Purch. Inv. Header" WHERE (Pay-to Vendor No.=FIELD(No.)));
                                                   CaptionML=[ENU=Pay-to No. of Pstd. Invoices;
                                                              ENC=Pay-to No. of Pstd. Invoices];
                                                   Editable=No }
    { 7187;   ;Pay-to No. of Pstd. Return S.;Integer;
                                                   FieldClass=FlowField;
                                                   CalcFormula=Count("Return Shipment Header" WHERE (Pay-to Vendor No.=FIELD(No.)));
                                                   CaptionML=[ENU=No. of Pstd. Return S.;
                                                              ENC=No. of Pstd. Return S.];
                                                   Editable=No }
    { 7188;   ;Pay-to No. of Pstd. Cr. Memos;Integer;
                                                   FieldClass=FlowField;
                                                   CalcFormula=Count("Purch. Cr. Memo Hdr." WHERE (Pay-to Vendor No.=FIELD(No.)));
                                                   CaptionML=[ENU=No. of Pstd. Cr. Memos;
                                                              ENC=No. of Pstd. Cr. Memos];
                                                   Editable=No }
    { 7189;   ;No. of Quotes       ;Integer       ;FieldClass=FlowField;
                                                   CalcFormula=Count("Purchase Header" WHERE (Document Type=CONST(Quote),
                                                                                              Buy-from Vendor No.=FIELD(No.)));
                                                   CaptionML=[ENU=No. of Quotes;
                                                              ENC=No. of Quotes];
                                                   Editable=No }
    { 7190;   ;No. of Blanket Orders;Integer      ;FieldClass=FlowField;
                                                   CalcFormula=Count("Purchase Header" WHERE (Document Type=CONST(Blanket Order),
                                                                                              Buy-from Vendor No.=FIELD(No.)));
                                                   AccessByPermission=TableData 120=R;
                                                   CaptionML=[ENU=No. of Blanket Orders;
                                                              ENC=No. of Blanket Orders];
                                                   Editable=No }
    { 7191;   ;No. of Orders       ;Integer       ;FieldClass=FlowField;
                                                   CalcFormula=Count("Purchase Header" WHERE (Document Type=CONST(Order),
                                                                                              Buy-from Vendor No.=FIELD(No.)));
                                                   AccessByPermission=TableData 120=R;
                                                   CaptionML=[ENU=No. of Orders;
                                                              ENC=No. of Orders] }
    { 7192;   ;No. of Invoices     ;Integer       ;FieldClass=FlowField;
                                                   CalcFormula=Count("Purchase Header" WHERE (Document Type=CONST(Invoice),
                                                                                              Buy-from Vendor No.=FIELD(No.)));
                                                   CaptionML=[ENU=No. of Invoices;
                                                              ENC=No. of Invoices];
                                                   Editable=No }
    { 7193;   ;No. of Return Orders;Integer       ;FieldClass=FlowField;
                                                   CalcFormula=Count("Purchase Header" WHERE (Document Type=CONST(Return Order),
                                                                                              Buy-from Vendor No.=FIELD(No.)));
                                                   AccessByPermission=TableData 6650=R;
                                                   CaptionML=[ENU=No. of Return Orders;
                                                              ENC=No. of Return Orders];
                                                   Editable=No }
    { 7194;   ;No. of Credit Memos ;Integer       ;FieldClass=FlowField;
                                                   CalcFormula=Count("Purchase Header" WHERE (Document Type=CONST(Credit Memo),
                                                                                              Buy-from Vendor No.=FIELD(No.)));
                                                   CaptionML=[ENU=No. of Credit Memos;
                                                              ENC=No. of Credit Memos];
                                                   Editable=No }
    { 7195;   ;No. of Order Addresses;Integer     ;FieldClass=FlowField;
                                                   CalcFormula=Count("Order Address" WHERE (Vendor No.=FIELD(No.)));
                                                   CaptionML=[ENU=No. of Order Addresses;
                                                              ENC=No. of Order Addresses];
                                                   Editable=No }
    { 7196;   ;Pay-to No. of Quotes;Integer       ;FieldClass=FlowField;
                                                   CalcFormula=Count("Purchase Header" WHERE (Document Type=CONST(Quote),
                                                                                              Pay-to Vendor No.=FIELD(No.)));
                                                   CaptionML=[ENU=Pay-to No. of Quotes;
                                                              ENC=Pay-to No. of Quotes];
                                                   Editable=No }
    { 7197;   ;Pay-to No. of Blanket Orders;Integer;
                                                   FieldClass=FlowField;
                                                   CalcFormula=Count("Purchase Header" WHERE (Document Type=CONST(Blanket Order),
                                                                                              Pay-to Vendor No.=FIELD(No.)));
                                                   AccessByPermission=TableData 120=R;
                                                   CaptionML=[ENU=Pay-to No. of Blanket Orders;
                                                              ENC=Pay-to No. of Blanket Orders] }
    { 7600;   ;Base Calendar Code  ;Code10        ;TableRelation="Base Calendar";
                                                   CaptionML=[ENU=Base Calendar Code;
                                                              ENC=Base Calendar Code] }
    { 7601;   ;Document Sending Profile;Code20    ;TableRelation="Document Sending Profile".Code;
                                                   CaptionML=[ENU=Document Sending Profile;
                                                              ENC=Document Sending Profile] }
    { 10004;  ;UPS Zone            ;Code2         ;CaptionML=[ENU=UPS Zone;
                                                              ENC=UPS Zone] }
    { 10016;  ;Federal ID No.      ;Text30        ;CaptionML=[ENU=Federal ID No.;
                                                              ENC=Federal BIN No.] }
    { 10017;  ;Bank Communication  ;Option        ;CaptionML=[ENU=Bank Communication;
                                                              ENC=Bank Communication];
                                                   OptionCaptionML=[ENU=E English,F French,S Spanish;
                                                                    ENC=E English,F French,S Spanish];
                                                   OptionString=E English,F French,S Spanish }
    { 10018;  ;Check Date Format   ;Option        ;InitValue=MM DD YYYY;
                                                   CaptionML=[ENU=Check Date Format;
                                                              ENC=Cheque Date Format];
                                                   OptionCaptionML=[ENU=" ,MM DD YYYY,DD MM YYYY,YYYY MM DD";
                                                                    ENC=" ,MM DD YYYY,DD MM YYYY,YYYY MM DD"];
                                                   OptionString=[ ,MM DD YYYY,DD MM YYYY,YYYY MM DD] }
    { 10019;  ;Check Date Separator;Option        ;InitValue=/;
                                                   CaptionML=[ENU=Check Date Separator;
                                                              ENC=Cheque Date Separator];
                                                   OptionCaptionML=[ENU=" ,-,.,/";
                                                                    ENC=" ,-,.,/"];
                                                   OptionString=[ ,-,.,/] }
    { 10020;  ;IRS 1099 Code       ;Code10        ;TableRelation="IRS 1099 Form-Box";
                                                   CaptionML=[ENU=IRS 1099 Code;
                                                              ENC=IRS 1099 Code] }
    { 10021;  ;Balance on Date     ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=-Sum("Detailed Vendor Ledg. Entry".Amount WHERE (Vendor No.=FIELD(No.),
                                                                                                                Posting Date=FIELD(UPPERLIMIT(Date Filter)),
                                                                                                                Initial Entry Global Dim. 1=FIELD(Global Dimension 1 Filter),
                                                                                                                Initial Entry Global Dim. 2=FIELD(Global Dimension 2 Filter),
                                                                                                                Currency Code=FIELD(Currency Filter)));
                                                   CaptionML=[ENU=Balance on Date;
                                                              ENC=Balance on Date];
                                                   Editable=No;
                                                   AutoFormatType=1;
                                                   AutoFormatExpr="Currency Code" }
    { 10022;  ;Balance on Date (LCY);Decimal      ;FieldClass=FlowField;
                                                   CalcFormula=-Sum("Detailed Vendor Ledg. Entry"."Amount (LCY)" WHERE (Vendor No.=FIELD(No.),
                                                                                                                        Posting Date=FIELD(UPPERLIMIT(Date Filter)),
                                                                                                                        Initial Entry Global Dim. 1=FIELD(Global Dimension 1 Filter),
                                                                                                                        Initial Entry Global Dim. 2=FIELD(Global Dimension 2 Filter),
                                                                                                                        Currency Code=FIELD(Currency Filter)));
                                                   CaptionML=[ENU=Balance on Date (LCY);
                                                              ENC=Balance on Date (LCY)];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 10023;  ;RFC No.             ;Code13        ;OnValidate=VAR
                                                                Vendor@1020000 : Record 23;
                                                              BEGIN
                                                                CASE "Tax Identification Type" OF
                                                                  "Tax Identification Type"::"Legal Entity":
                                                                    ValidateRFCNo(12);
                                                                  "Tax Identification Type"::"Natural Person":
                                                                    ValidateRFCNo(13);
                                                                END;
                                                                Vendor.RESET;
                                                                Vendor.SETRANGE("RFC No.","RFC No.");
                                                                Vendor.SETFILTER("No.",'<>%1',"No.");
                                                                IF Vendor.FINDFIRST THEN
                                                                  MESSAGE(Text10002,"RFC No.");
                                                              END;

                                                   CaptionML=[ENU=RFC No.;
                                                              ENC=RFC No.] }
    { 10024;  ;CURP No.            ;Code18        ;OnValidate=BEGIN
                                                                IF STRLEN("CURP No.") <> 18 THEN
                                                                  ERROR(Text10001,"CURP No.");
                                                              END;

                                                   CaptionML=[ENU=CURP No.;
                                                              ENC=CURP No.] }
    { 10025;  ;State Inscription   ;Text30        ;CaptionML=[ENU=State Inscription;
                                                              ENC=Province/State Inscription] }
    { 10026;  ;FATCA filing requirement;Boolean   ;CaptionML=[ENU=FATCA filing requirement;
                                                              ENC=FATCA filing requirement] }
    { 14020;  ;Tax Identification Type;Option     ;CaptionML=[ENU=Tax Identification Type;
                                                              ENC=Tax Identification Type];
                                                   OptionCaptionML=[ENU=Legal Entity,Natural Person;
                                                                    ENC=Legal Entity,Natural Person];
                                                   OptionString=Legal Entity,Natural Person }
    { 37001000;;One Check per Invoice;Boolean     ;CaptionML=[ENU=One Check per Invoice;
                                                              ENC=One Cheque per Invoice] }
    { 37001001;;One-Time Vendor    ;Boolean       ;CaptionML=[ENU=One-Time Vendor;
                                                              ENC=One-Time Vendor] }
    { 37001041;;Payables Fund No.  ;Code10        ;TableRelation=Fund;
                                                   OnValidate=BEGIN
                                                                FundManagement.CheckControlFundAP("Payables Fund No.");
                                                              END;

                                                   CaptionML=[ENU=Payables Fund No.;
                                                              ENC=Payables Fund No.] }
    { 37001042;;Proposed Vendor    ;Boolean       ;CaptionML=[ENU=Proposed Vendor;
                                                              ENC=Proposed Vendor];
                                                   Editable=No }
    { 37001043;;Allocation No.     ;Code10        ;TableRelation="Allocation Header".No. WHERE (Allocation Type=CONST(Line),
                                                                                                Calculation Type=FILTER(<>Calculated Line));
                                                   OnValidate=BEGIN
                                                                AllocationManagement.ValidateAllocationNo("Allocation No.",WORKDATE);
                                                              END;

                                                   CaptionML=[ENU=Allocation No.;
                                                              ENC=Allocation No.] }
    { 37001044;;G/L Account No.    ;Code20        ;TableRelation="G/L Account";
                                                   CaptionML=[ENU=G/L Account No.;
                                                              ENC=G/L Account No.] }
    { 37001050;;Fund No.           ;Code10        ;TableRelation=Fund;
                                                   CaptionML=[ENU=Fund No.;
                                                              ENC=Fund No.] }
    { 37001053;;Global Dimension 3 Code;Code10    ;TableRelation="Dimension Value".Code WHERE (Global Dimension No.=CONST(3));
                                                   OnValidate=BEGIN
                                                                ValidateShortcutDimCode(3,"Global Dimension 3 Code");
                                                                MODIFY;
                                                              END;

                                                   CaptionML=[ENU=Global Dimension 3 Code;
                                                              ENC=Global Dimension 3 Code];
                                                   CaptionClass='1,2,3' }
    { 37001054;;Global Dimension 4 Code;Code10    ;TableRelation="Dimension Value".Code WHERE (Global Dimension No.=CONST(4));
                                                   OnValidate=BEGIN
                                                                ValidateShortcutDimCode(4,"Global Dimension 4 Code");
                                                                MODIFY;
                                                              END;

                                                   CaptionML=[ENU=Global Dimension 4 Code;
                                                              ENC=Global Dimension 4 Code];
                                                   CaptionClass='1,2,4' }
    { 37001055;;Global Dimension 5 Code;Code10    ;TableRelation="Dimension Value".Code WHERE (Global Dimension No.=CONST(5));
                                                   OnValidate=BEGIN
                                                                ValidateShortcutDimCode(5,"Global Dimension 5 Code");
                                                                MODIFY;
                                                              END;

                                                   CaptionML=[ENU=Global Dimension 5 Code;
                                                              ENC=Global Dimension 5 Code];
                                                   CaptionClass='1,2,5' }
    { 37001056;;Global Dimension 6 Code;Code10    ;TableRelation="Dimension Value".Code WHERE (Global Dimension No.=CONST(6));
                                                   OnValidate=BEGIN
                                                                ValidateShortcutDimCode(6,"Global Dimension 6 Code");
                                                                MODIFY;
                                                              END;

                                                   CaptionML=[ENU=Global Dimension 6 Code;
                                                              ENC=Global Dimension 6 Code];
                                                   CaptionClass='1,2,6' }
    { 37001057;;Global Dimension 7 Code;Code10    ;TableRelation="Dimension Value".Code WHERE (Global Dimension No.=CONST(7));
                                                   OnValidate=BEGIN
                                                                ValidateShortcutDimCode(7,"Global Dimension 7 Code");
                                                                MODIFY;
                                                              END;

                                                   CaptionML=[ENU=Global Dimension 7 Code;
                                                              ENC=Global Dimension 7 Code];
                                                   CaptionClass='1,2,7' }
    { 37001058;;Global Dimension 8 Code;Code10    ;TableRelation="Dimension Value".Code WHERE (Global Dimension No.=CONST(8));
                                                   OnValidate=BEGIN
                                                                ValidateShortcutDimCode(8,"Global Dimension 8 Code");
                                                                MODIFY;
                                                              END;

                                                   CaptionML=[ENU=Global Dimension 8 Code;
                                                              ENC=Global Dimension 8 Code];
                                                   CaptionClass='1,2,8' }
    { 37001059;;Dimension Speedkey Code;Code10    ;TableRelation="Dimension Speedkey";
                                                   OnValidate=BEGIN
                                                                IF DimensionSpeedkey.GET("Dimension Speedkey Code") THEN BEGIN
                                                                  VALIDATE("Fund No.",DimensionSpeedkey."Fund No.");
                                                                  VALIDATE("Global Dimension 1 Code", DimensionSpeedkey."Global Dimension 1 Code");
                                                                  VALIDATE("Global Dimension 2 Code", DimensionSpeedkey."Global Dimension 2 Code");
                                                                  VALIDATE("Global Dimension 3 Code", DimensionSpeedkey."Global Dimension 3 Code");
                                                                  VALIDATE("Global Dimension 4 Code", DimensionSpeedkey."Global Dimension 4 Code");
                                                                  VALIDATE("Global Dimension 5 Code", DimensionSpeedkey."Global Dimension 5 Code");
                                                                  VALIDATE("Global Dimension 6 Code", DimensionSpeedkey."Global Dimension 6 Code");
                                                                  VALIDATE("Global Dimension 7 Code", DimensionSpeedkey."Global Dimension 7 Code");
                                                                  VALIDATE("Global Dimension 8 Code", DimensionSpeedkey."Global Dimension 8 Code");
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=Dimension Speedkey Code;
                                                              ENC=Dimension Speedkey Code] }
    { 37001140;;Deliver-to Address Code;Code10    ;TableRelation="Deliver-to Address";
                                                   CaptionML=[ENU=Deliver-to Address Code;
                                                              ENC=Deliver-to Address Code] }
    { 37001150;;Fund Filter        ;Code10        ;FieldClass=FlowFilter;
                                                   TableRelation=Fund;
                                                   CaptionML=[ENU=Fund Filter;
                                                              ENC=Fund Filter] }
    { 37001153;;Global Dimension 3 Filter;Code10  ;FieldClass=FlowFilter;
                                                   TableRelation="Dimension Value".Code WHERE (Global Dimension No.=CONST(3));
                                                   CaptionML=[ENU=Global Dimension 3 Filter;
                                                              ENC=Global Dimension 3 Filter];
                                                   CaptionClass='1,4,3' }
    { 37001154;;Global Dimension 4 Filter;Code10  ;FieldClass=FlowFilter;
                                                   TableRelation="Dimension Value".Code WHERE (Global Dimension No.=CONST(4));
                                                   CaptionML=[ENU=Global Dimension 4 Filter;
                                                              ENC=Global Dimension 4 Filter];
                                                   CaptionClass='1,4,4' }
    { 37001155;;Global Dimension 5 Filter;Code10  ;FieldClass=FlowFilter;
                                                   TableRelation="Dimension Value".Code WHERE (Global Dimension No.=CONST(5));
                                                   CaptionML=[ENU=Global Dimension 5 Filter;
                                                              ENC=Global Dimension 5 Filter];
                                                   CaptionClass='1,4,5' }
    { 37001156;;Global Dimension 6 Filter;Code10  ;FieldClass=FlowFilter;
                                                   TableRelation="Dimension Value".Code WHERE (Global Dimension No.=CONST(6));
                                                   CaptionML=[ENU=Global Dimension 6 Filter;
                                                              ENC=Global Dimension 6 Filter];
                                                   CaptionClass='1,4,6' }
    { 37001157;;Global Dimension 7 Filter;Code10  ;FieldClass=FlowFilter;
                                                   TableRelation="Dimension Value".Code WHERE (Global Dimension No.=CONST(7));
                                                   CaptionML=[ENU=Global Dimension 7 Filter;
                                                              ENC=Global Dimension 7 Filter];
                                                   CaptionClass='1,4,7' }
    { 37001158;;Global Dimension 8 Filter;Code10  ;FieldClass=FlowFilter;
                                                   TableRelation="Dimension Value".Code WHERE (Global Dimension No.=CONST(8));
                                                   CaptionML=[ENU=Global Dimension 8 Filter;
                                                              ENC=Global Dimension 8 Filter];
                                                   CaptionClass='1,4,8' }
    { 37001400;;Created By         ;Code50        ;TableRelation=User."User Name";
                                                   ValidateTableRelation=No;
                                                   TestTableRelation=No;
                                                   CaptionML=[ENU=Created By;
                                                              ENC=Created By];
                                                   Editable=No }
    { 37001410;;Date Created       ;Date          ;CaptionML=[ENU=Date Created;
                                                              ENC=Date Created];
                                                   Editable=No }
    { 37001430;;Last Modified By   ;Code50        ;TableRelation=User."User Name";
                                                   ValidateTableRelation=No;
                                                   TestTableRelation=No;
                                                   CaptionML=[ENU=Last Modified By;
                                                              ENC=Last Modified By];
                                                   Editable=No }
    { 37001460;;Transferred to Dest.;Boolean      ;CaptionML=[ENU=Transferred to Dest.;
                                                              ENC=Transferred to Dest.];
                                                   Description=Replicator }
    { 37001700;;AV Subawardee      ;Boolean       ;CaptionML=[ENU=AV Subawardee;
                                                              ENC=AV Subawardee] }
    { 37001701;;AV Subawards       ;Integer       ;FieldClass=FlowField;
                                                   CalcFormula=Count(Award WHERE (Document Type=CONST(Subaward),
                                                                                  Vendor No.=FIELD(No.)));
                                                   CaptionML=[ENU=AV Subawards;
                                                              ENC=AV Subawards];
                                                   Editable=No }
  }
  KEYS
  {
    {    ;No.                                     ;Clustered=Yes }
    {    ;Search Name                              }
    {    ;Vendor Posting Group                     }
    {    ;Currency Code                            }
    {    ;Priority                                 }
    {    ;Country/Region Code                      }
    {    ;Gen. Bus. Posting Group                  }
    {    ;VAT Registration No.                     }
    {    ;Name                                     }
    {    ;AV Subawardee                            }
    {    ;City                                     }
    {    ;Post Code                                }
    {    ;Phone No.                                }
    {    ;Contact                                  }
    {    ;Purchaser Code                           }
  }
  FIELDGROUPS
  {
    { 1   ;DropDown            ;No.,Name,City,Post Code,Phone No.,Contact }
    { 2   ;Brick               ;No.,Name,Balance (LCY),Contact,Balance Due (LCY),Image }
  }
  CODE
  {
    VAR
      Text000@1000 : TextConst 'ENU=You cannot delete %1 %2 because there is at least one outstanding Purchase %3 for this vendor.;ENC=You cannot delete %1 %2 because there is at least one outstanding Purchase %3 for this vendor.';
      Text002@1001 : TextConst 'ENU=You have set %1 to %2. Do you want to update the %3 price list accordingly?;ENC=You have set %1 to %2. Do you want to update the %3 price list accordingly?';
      Text003@1002 : TextConst 'ENU=Do you wish to create a contact for %1 %2?;ENC=Do you wish to create a contact for %1 %2?';
      PurchSetup@1003 : Record 312;
      CommentLine@1005 : Record 97;
      PostCode@1007 : Record 225;
      VendBankAcc@1008 : Record 288;
      OrderAddr@1009 : Record 224;
      GenBusPostingGrp@1010 : Record 250;
      ItemCrossReference@1016 : Record 5717;
      RMSetup@1020 : Record 5079;
      ServiceItem@1024 : Record 5940;
      NoSeriesMgt@1011 : Codeunit 396;
      MoveEntries@1012 : Codeunit 361;
      UpdateContFromVend@1013 : Codeunit 5057;
      DimMgt@1014 : Codeunit 408;
      ApprovalsMgmt@1028 : Codeunit 1535;
      InsertFromContact@1015 : Boolean;
      Text004@1019 : TextConst 'ENU=Contact %1 %2 is not related to vendor %3 %4.;ENC=Contact %1 %2 is not related to vendor %3 %4.';
      Text005@1021 : TextConst 'ENU=post;ENC=post';
      Text006@1022 : TextConst 'ENU=create;ENC=create';
      Text007@1023 : TextConst 'ENU=You cannot %1 this type of document when Vendor %2 is blocked with type %3;ENC=You cannot %1 this type of document when Vendor %2 is blocked with type %3';
      Text008@1025 : TextConst 'ENU=The %1 %2 has been assigned to %3 %4.\The same %1 cannot be entered on more than one %3.;ENC=The %1 %2 has been assigned to %3 %4.\The same %1 cannot be entered on more than one %3.';
      Text009@1027 : TextConst 'ENU=Reconciling IC transactions may be difficult if you change IC Partner Code because this %1 has ledger entries in a fiscal year that has not yet been closed.\ Do you still want to change the IC Partner Code?;ENC=Reconciling IC transactions may be difficult if you change IC Partner Code because this %1 has ledger entries in a fiscal year that has not yet been closed.\ Do you still want to change the IC Partner Code?';
      Text010@1026 : TextConst 'ENU=You cannot change the contents of the %1 field because this %2 has one or more open ledger entries.;ENC=You cannot change the contents of the %1 field because this %2 has one or more open ledger entries.';
      Text011@1004 : TextConst 'ENU=Before you can use Online Map, you must fill in the Online Map Setup window.\See Setting Up Online Map in Help.;ENC=Before you can use Online Map, you must fill in the Online Map Setup window.\See Setting Up Online Map in Help.';
      Text10000@1020001 : TextConst 'ENU=%1 is not a valid RFC No.;ENC=%1 is not a valid RFC No.';
      Text10001@1020000 : TextConst 'ENU=%1 is not a valid CURP No.;ENC=%1 is not a valid CURP No.';
      Text10002@1020002 : TextConst 'ENU=The RFC No. %1 is used by another company.;ENC=The RFC No. %1 is used by another company.';
      SelectVendorErr@1017 : TextConst 'ENU=You must select an existing vendor.;ENC=You must select an existing vendor.';
      CreateNewVendTxt@1129 : TextConst '@@@="%1 is the name to be used to create the customer. ";ENU=Create a new vendor card for %1.;ENC=Create a new vendor card for %1.';
      VendNotRegisteredTxt@1128 : TextConst 'ENU=This vendor is not registered. To continue, choose one of the following options:;ENC=This vendor is not registered. To continue, choose one of the following options:';
      SelectVendTxt@1118 : TextConst 'ENU=Select an existing vendor.;ENC=Select an existing vendor.';
      InsertFromTemplate@1018 : Boolean;
      "----------Navigator----------"@1102633007 : Integer;
      DimensionSpeedkey@1102633006 : Record 37001011;
      BusinessEntityRelation@1102633005 : Record 37001452;
      EFExtFieldEntry@1102633004 : Record 37071333;
      FileAttachment@1102633008 : Record 37071300;
      FundManagement@1102633003 : Codeunit 37001020;
      AllocationManagement@1102633002 : Codeunit 37001040;
      EFExtendedFieldsMgt@1102633000 : Codeunit 37071330;

    PROCEDURE AssistEdit@2(OldVend@1000 : Record 23) : Boolean;
    VAR
      Vend@1001 : Record 23;
    BEGIN
      WITH Vend DO BEGIN
        Vend := Rec;
        PurchSetup.GET;
        PurchSetup.TESTFIELD("Vendor Nos.");
        IF NoSeriesMgt.SelectSeries(PurchSetup."Vendor Nos.",OldVend."No. Series","No. Series") THEN BEGIN
          PurchSetup.GET;
          PurchSetup.TESTFIELD("Vendor Nos.");
          NoSeriesMgt.SetSeries("No.");
          Rec := Vend;
          EXIT(TRUE);
        END;
      END;
    END;

    LOCAL PROCEDURE ValidateShortcutDimCode@29(FieldNumber@1000 : Integer;VAR ShortcutDimCode@1001 : Code[20]);
    BEGIN
      DimMgt.ValidateDimValueCode(FieldNumber,ShortcutDimCode);
      DimMgt.SaveDefaultDim(DATABASE::Vendor,"No.",FieldNumber,ShortcutDimCode);
      MODIFY;
    END;

    PROCEDURE ShowContact@1();
    VAR
      ContBusRel@1000 : Record 5054;
      Cont@1001 : Record 5050;
      OfficeContact@1003 : Record 5050;
      OfficeMgt@1002 : Codeunit 1630;
    BEGIN
      IF OfficeMgt.GetContact(OfficeContact,"No.") AND (OfficeContact.COUNT = 1) THEN
        PAGE.RUN(PAGE::"Contact Card",OfficeContact)
      ELSE BEGIN
        IF "No." = '' THEN
          EXIT;

        ContBusRel.SETCURRENTKEY("Link to Table","No.");
        ContBusRel.SETRANGE("Link to Table",ContBusRel."Link to Table"::Vendor);
        ContBusRel.SETRANGE("No.","No.");
        IF NOT ContBusRel.FINDFIRST THEN BEGIN
          IF NOT CONFIRM(Text003,FALSE,TABLECAPTION,"No.") THEN
            EXIT;
          UpdateContFromVend.InsertNewContact(Rec,FALSE);
          ContBusRel.FINDFIRST;
        END;
        COMMIT;

        Cont.SETCURRENTKEY("Company Name","Company No.",Type,Name);
        Cont.SETRANGE("Company No.",ContBusRel."Contact No.");
        PAGE.RUN(PAGE::"Contact List",Cont);
      END;
    END;

    PROCEDURE SetInsertFromContact@3(FromContact@1000 : Boolean);
    BEGIN
      InsertFromContact := FromContact;
    END;

    PROCEDURE CheckBlockedVendOnDocs@4(Vend2@1003 : Record 23;Transaction@1000 : Boolean);
    BEGIN
      IF Vend2.Blocked = Vend2.Blocked::All THEN
        VendBlockedErrorMessage(Vend2,Transaction);
    END;

    PROCEDURE CheckBlockedVendOnJnls@5(Vend2@1005 : Record 23;DocType@1004 : ' ,Payment,Invoice,Credit Memo,Finance Charge Memo,Reminder,Refund';Transaction@1003 : Boolean);
    BEGIN
      WITH Vend2 DO BEGIN
        IF (Blocked = Blocked::All) OR
           (Blocked = Blocked::Payment) AND (DocType = DocType::Payment)
        THEN
          VendBlockedErrorMessage(Vend2,Transaction);
      END;
    END;

    PROCEDURE CreateAndShowNewInvoice@21();
    VAR
      PurchaseHeader@1000 : Record 38;
    BEGIN
      PurchaseHeader."Document Type" := PurchaseHeader."Document Type"::Invoice;
      PurchaseHeader.SETRANGE("Buy-from Vendor No.","No.");
      PurchaseHeader.INSERT(TRUE);
      COMMIT;
      PAGE.RUN(PAGE::"Purchase Invoice",PurchaseHeader)
    END;

    PROCEDURE CreateAndShowNewCreditMemo@22();
    VAR
      PurchaseHeader@1000 : Record 38;
    BEGIN
      PurchaseHeader."Document Type" := PurchaseHeader."Document Type"::"Credit Memo";
      PurchaseHeader.SETRANGE("Buy-from Vendor No.","No.");
      PurchaseHeader.INSERT(TRUE);
      COMMIT;
      PAGE.RUN(PAGE::"Purchase Credit Memo",PurchaseHeader)
    END;

    PROCEDURE CreateAndShowNewPurchaseOrder@12();
    VAR
      PurchaseHeader@1000 : Record 38;
    BEGIN
      PurchaseHeader."Document Type" := PurchaseHeader."Document Type"::Order;
      PurchaseHeader.SETRANGE("Buy-from Vendor No.","No.");
      PurchaseHeader.INSERT(TRUE);
      COMMIT;
      PAGE.RUN(PAGE::"Purchase Order",PurchaseHeader);
    END;

    PROCEDURE VendBlockedErrorMessage@1102628000(Vend2@1001 : Record 23;Transaction@1002 : Boolean);
    VAR
      Action@1000 : Text[30];
    BEGIN
      IF Transaction THEN
        Action := Text005
      ELSE
        Action := Text006;
      ERROR(Text007,Action,Vend2."No.",Vend2.Blocked);
    END;

    PROCEDURE DisplayMap@7();
    VAR
      MapPoint@1001 : Record 800;
      MapMgt@1000 : Codeunit 802;
    BEGIN
      IF MapPoint.FINDFIRST THEN
        MapMgt.MakeSelection(DATABASE::Vendor,GETPOSITION)
      ELSE
        MESSAGE(Text011);
    END;

    PROCEDURE CalcOverDueBalance@8() OverDueBalance : Decimal;
    VAR
      VendLedgEntryRemainAmtQuery@1001 : Query 25 SECURITYFILTERING(Filtered);
    BEGIN
      VendLedgEntryRemainAmtQuery.SETRANGE(Vendor_No,"No.");
      VendLedgEntryRemainAmtQuery.SETRANGE(IsOpen,TRUE);
      VendLedgEntryRemainAmtQuery.SETFILTER(Due_Date,'<%1',WORKDATE);
      VendLedgEntryRemainAmtQuery.OPEN;

      IF VendLedgEntryRemainAmtQuery.READ THEN
        OverDueBalance := VendLedgEntryRemainAmtQuery.Sum_Remaining_Amt_LCY;
    END;

    PROCEDURE ValidateRFCNo@1020000(Length@1020000 : Integer);
    BEGIN
      IF STRLEN("RFC No.") <> Length THEN
        ERROR(Text10000,"RFC No.");
    END;

    PROCEDURE GetInvoicedPrepmtAmountLCY@18() : Decimal;
    VAR
      PurchLine@1000 : Record 39;
    BEGIN
      PurchLine.SETCURRENTKEY("Document Type","Pay-to Vendor No.");
      PurchLine.SETRANGE("Document Type",PurchLine."Document Type"::Order);
      PurchLine.SETRANGE("Pay-to Vendor No.","No.");
      PurchLine.CALCSUMS("Prepmt. Amount Inv. (LCY)","Prepmt. VAT Amount Inv. (LCY)");
      EXIT(PurchLine."Prepmt. Amount Inv. (LCY)" + PurchLine."Prepmt. VAT Amount Inv. (LCY)");
    END;

    PROCEDURE GetTotalAmountLCY@10() : Decimal;
    BEGIN
      CALCFIELDS(
        "Balance (LCY)","Outstanding Orders (LCY)","Amt. Rcd. Not Invoiced (LCY)","Outstanding Invoices (LCY)");

      EXIT(
        "Balance (LCY)" + "Outstanding Orders (LCY)" +
        "Amt. Rcd. Not Invoiced (LCY)" + "Outstanding Invoices (LCY)" - GetInvoicedPrepmtAmountLCY);
    END;

    PROCEDURE HasAddress@25() : Boolean;
    BEGIN
      CASE TRUE OF
        Address <> '':
          EXIT(TRUE);
        "Address 2" <> '':
          EXIT(TRUE);
        City <> '':
          EXIT(TRUE);
        "Country/Region Code" <> '':
          EXIT(TRUE);
        County <> '':
          EXIT(TRUE);
        "Post Code" <> '':
          EXIT(TRUE);
        Contact <> '':
          EXIT(TRUE);
      END;

      EXIT(FALSE);
    END;

    PROCEDURE GetVendorNo@56(VendorText@1000 : Text[50]) : Code[20];
    VAR
      Vendor@1001 : Record 23;
      VendorNo@1002 : Code[20];
      VendorWithoutQuote@1003 : Text;
      VendorFilterFromStart@1004 : Text;
      VendorFilterContains@1005 : Text;
    BEGIN
      IF VendorText = '' THEN
        EXIT('');

      IF STRLEN(VendorText) <= MAXSTRLEN(Vendor."No.") THEN
        IF Vendor.GET(VendorText) THEN
          EXIT(Vendor."No.");

      VendorWithoutQuote := CONVERTSTR(VendorText,'''','?');

      Vendor.SETFILTER(Name,'''@' + VendorWithoutQuote + '''');
      IF Vendor.FINDFIRST THEN
        EXIT(Vendor."No.");
      Vendor.SETRANGE(Name);

      VendorFilterFromStart := '''@' + VendorWithoutQuote + '*''';

      Vendor.FILTERGROUP := -1;
      Vendor.SETFILTER("No.",VendorFilterFromStart);
      Vendor.SETFILTER(Name,VendorFilterFromStart);
      IF Vendor.FINDFIRST THEN
        EXIT(Vendor."No.");

      VendorFilterContains := '''@*' + VendorWithoutQuote + '*''';

      Vendor.SETFILTER("No.",VendorFilterContains);
      Vendor.SETFILTER(Name,VendorFilterContains);
      Vendor.SETFILTER(City,VendorFilterContains);
      Vendor.SETFILTER(Contact,VendorFilterContains);
      Vendor.SETFILTER("Phone No.",VendorFilterContains);
      Vendor.SETFILTER("Post Code",VendorFilterContains);

      IF Vendor.COUNT = 0 THEN
        MarkVendorsWithSimilarName(Vendor,VendorText);

      IF Vendor.COUNT = 1 THEN BEGIN
        Vendor.FINDFIRST;
        EXIT(Vendor."No.");
      END;

      IF NOT GUIALLOWED THEN
        ERROR(SelectVendorErr);

      IF Vendor.COUNT = 0 THEN BEGIN
        IF Vendor.WRITEPERMISSION THEN
          CASE STRMENU(STRSUBSTNO('%1,%2',STRSUBSTNO(CreateNewVendTxt,VendorText),SelectVendTxt),1,VendNotRegisteredTxt) OF
            0:
              ERROR(SelectVendorErr);
            1:
              EXIT(CreateNewVendor(COPYSTR(VendorText,1,MAXSTRLEN(Vendor.Name))));
          END;
        Vendor.RESET;
      END;

      VendorNo := PickVendor(Vendor);
      IF VendorNo <> '' THEN
        EXIT(VendorNo);

      ERROR(SelectVendorErr);
    END;

    LOCAL PROCEDURE MarkVendorsWithSimilarName@33(VAR Vendor@1001 : Record 23;VendorText@1000 : Text);
    VAR
      TypeHelper@1002 : Codeunit 10;
      VendorCount@1003 : Integer;
      VendorTextLenght@1004 : Integer;
      Treshold@1005 : Integer;
    BEGIN
      IF VendorText = '' THEN
        EXIT;
      IF STRLEN(VendorText) > MAXSTRLEN(Vendor.Name) THEN
        EXIT;
      VendorTextLenght := STRLEN(VendorText);
      Treshold := VendorTextLenght DIV 5;
      IF Treshold = 0 THEN
        EXIT;
      Vendor.RESET;
      Vendor.ASCENDING(FALSE); // most likely to search for newest Vendors
      IF Vendor.FINDSET THEN
        REPEAT
          VendorCount += 1;
          IF ABS(VendorTextLenght - STRLEN(Vendor.Name)) <= Treshold THEN
            IF TypeHelper.TextDistance(UPPERCASE(VendorText),UPPERCASE(Vendor.Name)) <= Treshold THEN
              Vendor.MARK(TRUE);
        UNTIL Vendor.MARK OR (Vendor.NEXT = 0) OR (VendorCount > 1000);
      Vendor.MARKEDONLY(TRUE);
    END;

    LOCAL PROCEDURE CreateNewVendor@59(VendorName@1000 : Text[50]) : Code[20];
    VAR
      Vendor@1005 : Record 23;
      MiniVendorTemplate@1006 : Record 1303;
      VendorCard@1002 : Page 26;
    BEGIN
      IF NOT MiniVendorTemplate.NewVendorFromTemplate(Vendor) THEN
        ERROR(SelectVendorErr);

      Vendor.Name := VendorName;
      Vendor.MODIFY(TRUE);
      COMMIT;
      Vendor.SETRANGE("No.",Vendor."No.");
      VendorCard.SETTABLEVIEW(Vendor);
      IF NOT (VendorCard.RUNMODAL = ACTION::OK) THEN
        ERROR(SelectVendorErr);

      EXIT(Vendor."No.");
    END;

    LOCAL PROCEDURE PickVendor@58(VAR Vendor@1000 : Record 23) : Code[20];
    VAR
      VendorList@1001 : Page 27;
    BEGIN
      IF Vendor.FINDSET THEN
        REPEAT
          Vendor.MARK(TRUE);
        UNTIL Vendor.NEXT = 0;
      IF Vendor.FINDFIRST THEN;
      Vendor.MARKEDONLY := TRUE;

      VendorList.SETTABLEVIEW(Vendor);
      VendorList.SETRECORD(Vendor);
      VendorList.LOOKUPMODE := TRUE;
      IF VendorList.RUNMODAL = ACTION::LookupOK THEN
        VendorList.GETRECORD(Vendor)
      ELSE
        CLEAR(Vendor);

      EXIT(Vendor."No.");
    END;

    PROCEDURE OpenVendorLedgerEntries@9(FilterOnDueEntries@1002 : Boolean);
    VAR
      DetailedVendorLedgEntry@1001 : Record 380;
      VendorLedgerEntry@1000 : Record 25;
    BEGIN
      DetailedVendorLedgEntry.SETRANGE("Vendor No.","No.");
      COPYFILTER("Global Dimension 1 Filter",DetailedVendorLedgEntry."Initial Entry Global Dim. 1");
      COPYFILTER("Global Dimension 2 Filter",DetailedVendorLedgEntry."Initial Entry Global Dim. 2");
      IF FilterOnDueEntries AND (GETFILTER("Date Filter") <> '') THEN BEGIN
        COPYFILTER("Date Filter",DetailedVendorLedgEntry."Initial Entry Due Date");
        DetailedVendorLedgEntry.SETFILTER("Posting Date",'<=%1',GETRANGEMAX("Date Filter"));
      END;
      COPYFILTER("Currency Filter",DetailedVendorLedgEntry."Currency Code");
      VendorLedgerEntry.DrillDownOnEntries(DetailedVendorLedgEntry);
    END;

    PROCEDURE SetInsertFromTemplate@11(FromTemplate@1000 : Boolean);
    BEGIN
      InsertFromTemplate := FromTemplate;
    END;

    PROCEDURE "----------Navigator---------"@1102602002();
    BEGIN
    END;

    PROCEDURE SetUserAccess@1102602001();
    VAR
      GLSetup@1102602006 : Record 98;
      BusinessRuleHeader@1102602001 : TEMPORARY Record 37001000;
      BusinessRuleLine@1102602002 : Record 37001001;
      FundManagement@1102602004 : Codeunit 37001020;
      NewFilter@1102602000 : Code[1024];
    BEGIN
      GLSetup.GET;
      FundManagement.GetBusinessRulesForUserAccess(BusinessRuleHeader);

      IF BusinessRuleHeader.FINDSET(FALSE) THEN
        REPEAT
          BusinessRuleLine.RESET;
          BusinessRuleLine.SETRANGE("Business Rule Type",BusinessRuleLine."Business Rule Type"::UserAccess);
          BusinessRuleLine.SETRANGE("Business Rule Code",BusinessRuleHeader.Code);
          BusinessRuleLine.SETRANGE("Effective Date",BusinessRuleHeader."Effective Date");

          IF BusinessRuleLine.FINDSET(FALSE) THEN
            REPEAT
              CASE BusinessRuleLine."Business Object Code" OF
                'VENDOR':
                  BEGIN
                    FILTERGROUP(20);
                    IF GETFILTER("No.") = '' THEN
                      SETFILTER("No.",BusinessRuleLine.Filter)
                    ELSE BEGIN
                      NewFilter := GETFILTER("No.") + '|' + BusinessRuleLine.Filter;
                      SETFILTER("No.",NewFilter);
                    END;
                    FILTERGROUP(0);
                  END;
                GLSetup."Global Dimension 1 Code" :
                  BEGIN
                    FILTERGROUP(21);
                    IF GETFILTER("Global Dimension 1 Filter") = '' THEN
                      SETFILTER("Global Dimension 1 Filter",BusinessRuleLine.Filter)
                    ELSE BEGIN
                      NewFilter := GETFILTER("Global Dimension 1 Filter") + '|' + BusinessRuleLine.Filter;
                      SETFILTER("Global Dimension 1 Filter",NewFilter);
                    END;
                    FILTERGROUP(0);
                  END;
                GLSetup."Global Dimension 2 Code" :
                  BEGIN
                    FILTERGROUP(22);
                    IF GETFILTER("Global Dimension 2 Filter") = '' THEN
                      SETFILTER("Global Dimension 2 Filter",BusinessRuleLine.Filter)
                    ELSE BEGIN
                      NewFilter := GETFILTER("Global Dimension 2 Filter") + '|' + BusinessRuleLine.Filter;
                      SETFILTER("Global Dimension 2 Filter",NewFilter);
                    END;
                    FILTERGROUP(0);
                  END;
                GLSetup."Shortcut Dimension 3 Code" :
                  BEGIN
                    FILTERGROUP(23);
                    IF GETFILTER("Global Dimension 3 Filter") = '' THEN
                      SETFILTER("Global Dimension 3 Filter",BusinessRuleLine.Filter)
                    ELSE BEGIN
                      NewFilter := GETFILTER("Global Dimension 3 Filter") + '|' + BusinessRuleLine.Filter;
                      SETFILTER("Global Dimension 3 Filter",NewFilter);
                    END;
                    FILTERGROUP(0);
                  END;
                GLSetup."Shortcut Dimension 4 Code" :
                  BEGIN
                    FILTERGROUP(24);
                    IF GETFILTER("Global Dimension 4 Filter") = '' THEN
                      SETFILTER("Global Dimension 4 Filter",BusinessRuleLine.Filter)
                    ELSE BEGIN
                      NewFilter := GETFILTER("Global Dimension 4 Filter") + '|' + BusinessRuleLine.Filter;
                      SETFILTER("Global Dimension 4 Filter",NewFilter);
                    END;
                    FILTERGROUP(0);
                  END;
                GLSetup."Shortcut Dimension 5 Code" :
                  BEGIN
                    FILTERGROUP(25);
                    IF GETFILTER("Global Dimension 5 Filter") = '' THEN
                      SETFILTER("Global Dimension 5 Filter",BusinessRuleLine.Filter)
                    ELSE BEGIN
                      NewFilter := GETFILTER("Global Dimension 5 Filter") + '|' + BusinessRuleLine.Filter;
                      SETFILTER("Global Dimension 5 Filter",NewFilter);
                    END;
                    FILTERGROUP(0);
                  END;
                GLSetup."Shortcut Dimension 6 Code" :
                  BEGIN
                    FILTERGROUP(26);
                    IF GETFILTER("Global Dimension 6 Filter") = '' THEN
                      SETFILTER("Global Dimension 6 Filter",BusinessRuleLine.Filter)
                    ELSE BEGIN
                      NewFilter := GETFILTER("Global Dimension 6 Filter") + '|' + BusinessRuleLine.Filter;
                      SETFILTER("Global Dimension 6 Filter",NewFilter);
                    END;
                    FILTERGROUP(0);
                  END;
                GLSetup."Shortcut Dimension 7 Code" :
                  BEGIN
                    FILTERGROUP(27);
                    IF GETFILTER("Global Dimension 7 Filter") = '' THEN
                      SETFILTER("Global Dimension 7 Filter",BusinessRuleLine.Filter)
                    ELSE BEGIN
                      NewFilter := GETFILTER("Global Dimension 7 Filter") + '|' + BusinessRuleLine.Filter;
                      SETFILTER("Global Dimension 7 Filter",NewFilter);
                    END;
                    FILTERGROUP(0);
                  END;
                GLSetup."Shortcut Dimension 8 Code" :
                  BEGIN
                    FILTERGROUP(28);
                    IF GETFILTER("Global Dimension 8 Filter") = '' THEN
                      SETFILTER("Global Dimension 8 Filter",BusinessRuleLine.Filter)
                    ELSE BEGIN
                      NewFilter := GETFILTER("Global Dimension 8 Filter") + '|' + BusinessRuleLine.Filter;
                      SETFILTER("Global Dimension 8 Filter",NewFilter);
                    END;
                    FILTERGROUP(0);
                  END;
                'FUND':
                  BEGIN
                    FILTERGROUP(29);
                    IF GETFILTER("Fund Filter") = '' THEN
                      SETFILTER("Fund Filter",BusinessRuleLine.Filter)
                    ELSE BEGIN
                      NewFilter := GETFILTER("Fund Filter") + '|' + BusinessRuleLine.Filter;
                      SETFILTER("Fund Filter",NewFilter);
                    END;
                    FILTERGROUP(0);
                  END;
              END;
            UNTIL BusinessRuleLine.NEXT = 0;
        UNTIL BusinessRuleHeader.NEXT = 0;
      FILTERGROUP(0);
    END;

    PROCEDURE CopyProposedVendor@1102602004(ProposedVendor@1102602000 : Record 23);
    VAR
      FromCommentLine@1102602001 : Record 97;
      ToCommentLine@1102602002 : Record 97;
      RequisitionHeader@1102602004 : Record 37001090;
      RequisitionLine@1102602003 : Record 37001091;
    BEGIN
      IF (ProposedVendor."No." = '') OR (NOT ProposedVendor."Proposed Vendor") OR ("No." = '') THEN
        EXIT;
      IF Name <> '' THEN
        EXIT;

      VALIDATE(Name,ProposedVendor.Name);
      VALIDATE("Name 2",ProposedVendor."Name 2");
      VALIDATE(Address,ProposedVendor.Address);
      VALIDATE("Address 2",ProposedVendor."Address 2");
      VALIDATE(City,ProposedVendor.City);
      VALIDATE(Contact,ProposedVendor.Contact);
      VALIDATE("Phone No.",ProposedVendor."Phone No.");
      VALIDATE("Fax No.",ProposedVendor."Fax No.");
      VALIDATE("Post Code",ProposedVendor."Post Code");
      VALIDATE(County,ProposedVendor.County);
      VALIDATE("E-Mail",ProposedVendor."E-Mail");
      VALIDATE("Home Page",ProposedVendor."Home Page");
      VALIDATE("Primary Contact No.",ProposedVendor."Primary Contact No.");
      "Created By" := ProposedVendor."Created By";
      "Date Created" := ProposedVendor."Date Created";
      MODIFY(TRUE);

      FromCommentLine.SETRANGE("Table Name",FromCommentLine."Table Name"::Vendor);
      FromCommentLine.SETRANGE("No.","No.");
      IF FromCommentLine.FINDSET(FALSE) THEN
        REPEAT
          ToCommentLine := FromCommentLine;
          ToCommentLine."No." := "No.";
          ToCommentLine.INSERT;
        UNTIL FromCommentLine.NEXT = 0;

      RequisitionLine.SETRANGE("Buy-from Vendor No.",ProposedVendor."No.");
      IF RequisitionLine.FINDSET(TRUE,FALSE) THEN
        REPEAT
          RequisitionLine.VALIDATE("Buy-from Vendor No.","No.");
          RequisitionLine.MODIFY;
        UNTIL RequisitionLine.NEXT = 0;

      RequisitionHeader.SETRANGE("Buy-from Vendor No.",ProposedVendor."No.");
      IF RequisitionHeader.FINDSET(TRUE,FALSE) THEN
        REPEAT
          RequisitionHeader."Buy-from Vendor No." := "No.";
          RequisitionHeader.MODIFY;
        UNTIL RequisitionHeader.NEXT = 0;

      ProposedVendor.DELETE;
    END;

    BEGIN
    {
      Serenic Navigator - (c)Copyright Serenic Software, Inc. 1999-2017.
      By opening this object you acknowledge that this object includes confidential information
      and intellectual property of Serenic Software, Inc., and that this work is protected by US
      and international copyright laws and agreements.
      ------------------------------------------------------------------------------------------
    }
    END.
  }
}

